const e=["1 - Elija un documeto Excel.","2 - Seleccione la hoja que contenga los datos para la toma de ramos, ejemplo: Asignaturas, Horarios o Profesor.","3 - Seleccione los valores de los filtros.","4 - Seleccione las caracteristicas de como se mostraran para cada horario."],t=["Completo","Progresivo","Único"],o=["Por rangos de","Todos los horarios"],a=["No","Si"],s=["Carga académica semanal","Resumen de carga académica","Resumen de carga académica en texto","Lista simple de cargas académica","Carga académica semanal con resumen de sesiones"],c=["Sin ordenar","De los más cercanos a las 8 horas","De los más cercanos a las 23 horas","De los que tienen más ventanas a los que tienen menos","De los que tienen menos ventanas a los que tienen más"],r=["Métricas","Métricas + Selección"],l=["Rechazadas","Aprobadas","Todos"],n=["Ninguno","Sin día libre","Con día libre"],i=["Ninguno","Sin alguna ventana","Con ventana"],d=["Ninguno","Fuera del máximo de asignatura","Dentro del máximo de asignatura"],$=["rechazadas","aprobadas","todas"],h=["sin día libre","con día libre"],u=["que le falte alguna ventana","con todas las ventana"],f=["fuera del máximo de asignatura","dentro del máximo de asignatura"],b=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],m=["Lu","Ma","Mi","Ju","Vi","Sa"],v=void 0,p=1e5,g=6e4,y="0",S="1",w="2",_=" / ",C="margen",k="",x="change",A="click",D="beforeend",E="radio",M="checkbox",q="sin definir",N="online",z="no aplica",T="primeros",I="últimos",R="selección",L="lista",j="wait",O="default",P="metricas",U="Q",B="Año",H="Período",V="Sede",F="Escuela",G="Carrera",J="Plan",Q="Tipo Plan de Estudio",X="Jornada",W="Nivel",Y="Asignatura",Z="Asignatura en malla",K="Nombre Asignatura",ee="Sección",te="Horario",oe="Docente",ae="Sala",se="Día",ce="Inicia",re="Termina",le="Start",ne="End",ie="Duración",de="Grupos",$e="Queda",he="#48a3ff",ue="#f8d7da",fe="#ff0000",be="0:00:00",me=`${be} - ${be}`,ve="Excel con mas datos de los nesesarios.",pe="La sección no presenta un mínimo de un horario para trabajar, por ello no podra visualizar las asignaturas en pantalla.",ge="Seleccione todos los filtros requeridos: Carrera, Jornada, Semestres y Asignaturas",ye="Debe elegir al menos una asignatura para elegir un máximo de asignatura por día.",Se="Debe seleccionar almenos una sección de cada asignatura que eligió",we="No hay rangos númericos que mostrar.",_e="No se considera el valor",Ce="Mostrar carga/s académica/s seleccionada/s",ke=`Tiene que haber dado click en el botón "${Ce}".`,xe="Selecciones una carga académica que quiera ver.",Ae="div_ejemplo",De="div_container",Ee="2",Me="4",qe="10",Ne="11",ze="12",Te="13",Ie="14",Re="15",Le="16",je="17",Oe="18",Pe="19",Ue="20",Be="21",He="22",Ve="23",Fe="24",Ge="25",Je="26",Qe="27",Xe="28",We="29",Ye="30",Ze="31",Ke="32",et="33",tt="34",ot="35",at="36",st="37",ct="38",rt="39",lt="40",nt="41",it="42",dt="43",$t="44",ht="45",ut="46",ft="47",bt="48",mt="49",vt="50",pt="51",gt="52",yt="53",St="54",wt="55",_t="56",Ct="57",kt="58",xt="59",At="60",Dt="61",Et="62",Mt="63",qt="64",Nt="65",zt="66",Tt="67",It="68",Rt="69",Lt="70",jt="71",Ot="72",Pt="73",Ut="74",Bt="75",Ht=Symbol(),Vt={},Ft={},Gt={},Jt={},Qt={},Xt={},Wt={},Yt=()=>{let e;return{t:t=>{e===v&&(e=t)},get:()=>e,set:t=>{e=t}}},Zt=Yt(),Kt=Yt(),eo=Yt(),to=Yt(),oo=Yt(),ao=Yt(),so=Yt(),co=Yt(),ro=Yt(),lo=Yt(),no=(Yt(),Yt()),io=(Yt(),()=>{"function"!=typeof Set.prototype.isSubsetOf&&(Set.prototype.isSubsetOf=function(e){for(const t of this)if(!e.has(t))return!1;return!0}),"function"!=typeof Set.prototype.difference&&(Set.prototype.difference=function(e){const t=new Set;for(const o of this)e.has(o)||t.add(o);return t})}),$o=(e,t)=>[...new Set(e.map(e=>e[t]))],ho=e=>document.getElementById(e),uo=e=>document.getElementsByName(e),fo=(e,t)=>{ho(e).insertAdjacentHTML(D,t)},bo=(e,t,o)=>{ho(e).addEventListener(t,o)},mo=(e,t)=>{ho(e).innerHTML=t},vo=e=>{mo(e,k)},po=(e,t)=>e.hasOwnProperty(t),go=e=>`<select multiple class="form-control" id="${e}" size="8"></select>`,yo=e=>`<option>${e.sort().join("</option><option>")}</option>`,So=e=>`<h6>${e}</h6>`,wo=e=>`<div id="${e}"></div>`,_o=(e,t)=>`<div class="${e}" id="${t}"></div>`,Co=(e,t,o,a,s)=>`<div class="form-check"><input class="form-check-input" type="${e}" name="${t}" id="${t}_${o}" value="${s}" ><label class="form-check-label">${a}</label></div>`,ko=(e,t)=>`Ya esta viendo las ${e} cargas académicas de la ${t}.`,xo=()=>{ro.set(v)},Ao=e=>{const t=e.target.files;if(0===t.length)return void alert(`Aunque no haya seleccionado un archivo excel se mantienen los datos de ${Vt[Ht]}`);if(t.length>1)return console.warn(ve);const o=t[0];Vt[Ht]=o.name;const a=new FileReader;a.onload=e=>{const t=e.target.result;Zt.set(XLSX.read(t,{type:"binary"})),ea(1),Io(1),Ko(0),Ys(1),ta(0),Zs(),Wa(0,0)},a.onerror=e=>{console.warn(e)},a.readAsBinaryString(o)},Do=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,Eo=e=>{const t=e?"dark":"light";var o;e&&(o="html",document.querySelector(o)).setAttribute("data-bs-theme","dark");fo(Ae,`<img src="img/ejemplo ${t}.png" class="img-fluid" alt="Imagen de ejemplo del contenido que puede tener un Archibo Ecxel" >`)},Mo=()=>{const t=`<div class="mb-3"><label for="formFile" class="form-label">${So(e[0])}</label><input class="form-control" id="${Le}" name="files[]" type="file"></div>`;mo("1",t),bo(Le,x,Ao)},qo=(io(),Eo(Do()),(()=>{const e=_o(C,"1")+_o(C,Ee)+_o(C,"3")+_o(C,Me)+_o(C,"6")+_o(C,"5")+_o(C,"7")+_o(C,"8")+_o(C,"9")+_o(C,qe)+_o(C,Ne)+_o("p-2",ze)+_o(C,Te)+_o(C,Ie)+_o(C,Re);fo(De,e)})(),Mo(),l.splice(2,1),()=>{No(),zo()}),No=()=>{delete Gt.o},zo=()=>{delete Gt.l},To=()=>{Gt.l=[]},Io=t=>{if(!t)return void vo(Ee);const o=`${So(e[1])}`;mo(Ee,o),Zt.get().SheetNames.forEach((e,t)=>{const o=Co(E,je,t,e,e);fo(Ee,o),bo(`${je}_${t}`,x,Ro)})},Ro=async e=>{Wt[B]=[],Wt[H]=[],Wt[V]=[],Wt[F]=[],Wt[G]=[],Wt[J]=[],Wt[Q]=[],Wt[X]=[],Wt[W]=[],Wt[Y]=[],Wt[Z]=[],Wt[K]=[],Wt[ee]=[],Wt[te]=[],Wt[oe]=[],Wt[ae]=[],Wt[se]=[],Po(e),(()=>{if(no.set(po(Kt.get()[0],se)),!po(Kt.get()[0],te))ea(1),Ko(0),Ys(1),ta(0),Zs(),Wa(0,0),xo()})(),Lo(),Go(),Ko(1)},Lo=()=>{jo(),Oo()},jo=()=>{to.set((()=>{const e=Kt.get();if(!e||0===e.length)return console.error("No parsed Excel data available"),null;const t=e[0];return[K,Y,Z].find(e=>t.hasOwnProperty(e))||(console.warn("No valid subject property found in Excel data. Available properties:",Object.keys(t)),null)})())},Oo=()=>{oo.set(Fo())},Po=e=>{const t=e.currentTarget.value,o=Zt.get().Sheets[t],a=XLSX.utils.sheet_to_row_object_array(o);Kt.set(structuredClone(a))},Uo=e=>Date.parse("1970-01-01T"+e+".000"),Bo=e=>e.padStart(8,"0"),Ho=(e,t)=>{const o=Math.max(...t.filter(t=>t<=e),-1);return{i:t.findIndex(e=>e==o)+1,$:e-o}},Vo=(e,t)=>{const o=t.split(" "),a=o[1],s=o[3],{h:c,u:r,m:l}=((e,t)=>{try{const o=Bo(e),a=Bo(t),s=Uo(o),c=Uo(a),r=s/g,l=c/g,n=l-r;return isNaN(n)&&console.error("Error: La duración es NaN"),{h:r,u:l,m:n}}catch(e){}})(a,s);e[ce]=c,e[re]=r,e[le]=a,e[ne]=s,e[ie]=l;const n=oo.get()(l),{i:i,$:d}=Ho(l,n);e[de]=i,e[$e]=d,((e,t)=>{t>0&&(e[U]="R")})(e,d)},Fo=()=>{let e,t=function(o){const a=[[39,79,119,159,199,239,279,319,359,399,439,479,519,559,599],[44,89,134,179,224,269,314,359,404,449,494,539,584,629,674]];for(const t of a)if(t.includes(o)){e=t;break}return t=()=>e,t(o)};return e=>t(e)},Go=()=>{for(let e=0;e<Kt.get().length;e++){const t=Kt.get()[e];Xo(t);const o=t[te];Jo(o)?t[U]="Z":Qo(t,o,e)}},Jo=e=>e==me||e.toLowerCase()==N||e.toLowerCase()==z,Qo=(e,t,o)=>{e[U]="A";const a=e[ae],s=e[oe],c=e[se];if(t.includes(_)){Kt.get().splice(o,1);const r=a.split(_),l=s.split(_),n=c.split(_),i=t.split(_);for(let a=0;a<i.length;a++)e[ae]=r[a],e[oe]=l[a],e[se]=n[a],e[te]=i[a],Vo(e,t),Kt.get().splice(o,0,e)}else Vo(e,t)},Xo=e=>{e[ae]===v&&(e[ae]=q),e[oe]===v&&(e[oe]=q),e[W]===v&&(e[W]=e["v"]||q)},Wo=t=>{const o=t?`<div class="row">${So(e[3])}<div class="col-12 col-md-6 col-lg-3"><h6>¿Quiere ver con color las sesiones?</h6><div id="${_t}" class="form-check"></div></div><div class="col-12 col-md-6 col-lg-9"><div id="${xt}" class="form-check"></div></div></div>`:k;mo("6",o);mo("5",t?`<div class="row"><div class="col-12"><p class="d-inline-flex gap-1"><a class="btn btn-outline-info" data-bs-toggle="collapse" href="#${Pt}" role="button" aria-expanded="false" aria-controls="${Pt}">Mostrar o no todas las secciones juntas</a></p><div class="collapse" id="${Pt}"><div id="${lt}" class="form-check"></div></div></div></div>`:k);mo("7",t?`<div class="row"><div class="col-12 col-md-3"><h6>Dibujar:</h6><div id="${nt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Ordenar:</h6><div id="${tt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Qué mostrar?:</h6><div id="${at}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Ver por lugares o todas las cargas académica?:</h6><div id="${ct}" class="form-check"></div></div></div>`:k);mo("8",t?`<div class="row"><svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></symbol></svg><div class="alert alert-primary d-flex align-items-center" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:"><use xlink:href="#info-fill"/></svg><div>Un <strong>horario</strong> es un bloque con hora de inicio y fin.<br>Una <strong>sección</strong> puede estar en varios días y tener varios horarios.<br>Una <strong>carga académica aprobada</strong> es aquella cuyos horarios no se superponen entre sí.</div></div><div class="col-12 col-md-3"><h6>Buscar las:</h6><div id="${mt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen días libres:</h6><div id="${vt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen ventana luego de una sección:</h6><div id="${pt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen máximo de asignaturas por día:</h6><div id="${gt}" class="form-check"></div><div id="${yt}" class="form-check"></div></div></div>`:k),Yo(t)},Yo=e=>{mo("9",e?`<div class="row"><div class="col-12 col-md-2"><h6>Procesado:</h6><div id="${dt}" class="form-check"></div></div><div class="col-12 col-md-2"><div id="${Dt}"></div></div><div class="col-12 col-md-4"><div id="${Ct}"></div></div><div class="col-12 col-md-4"><div id="${Et}"></div></div></div>`:k)},Zo=t=>{const o=t?`<div class="row">${So(e[2])}<div class="col-12 col-md-8"><h6>Carrera (requerida selección)</h6><div id="${He}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Jornada (recomendada selección)</h6><div id="${Fe}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-6"><h6>Plan o malla (recomendada selección)</h6><div id="${Je}" class="form-check"></div></div><div class="col-12 col-md-6"><h6>Semenstres (requerida selección)</h6><div id="${Xe}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-8"><h6>Asignaturas (requerida selección)</h6><div id="${Ye}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Sección (selección opcional)</h6><div id="${Ke}" class="form-check"></div></div></div>`:k;mo("3",o)},Ko=e=>{if(!e)return Wo(0),Zo(0),void Qs(0);Zo(1),Wo(1),oc(),oa(1),aa(1),sa(1),ca(1),la(1),na(1),Xs(0),Da(),da(),ha(),$a(),ua(),fa(),ba(),ma(),va(),pa(),ga(),Sa(1),wa(1),ta(1),Ys(2),Qs(0),Zs(),Ga()},ea=e=>{mo(qe,e?`<div class="row"><div class="col-12 col-sm-12 col-md-6"><div id="${Oe}"></div></div><div class="col-12 col-sm-12 col-md-6"><div id="${Mt}"></div></div></div>`:k)},ta=e=>{mo(Oe,e?`<div class="d-grid gap-2 col-6 mx-auto"><button type="button" class="btn btn-secondary" id="${Pe}">Mostrar selección</button><button type="button" class="btn btn-secondary" id="${Ue}">Reiniciar filtros</button><button type="button" class="btn btn-secondary" id="${Be}">Borrar cargas académicas mostradas</button></div>`:k),e&&(bo(Pe,A,()=>{Ta()}),bo(Ue,A,()=>{Ko(1)}),bo(Be,A,()=>{Zs(),Ys(1)}))},oa=e=>{if(1===e){const e=go(Ve);mo(He,e),bo(Ve,x,()=>{oa(3),qo()})}if(2===e||1===e){const t=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),o=$o(t,G),a=yo(o);return void mo(Ve,a)}3===e&&(Ma(1),aa(2),sa(2),ca(2),la(2),na(2),Da(),Ys(2),Qs(0),Zs())},aa=e=>{if(1===e){const e=go(Ge);mo(Fe,e),bo(Ge,x,()=>{aa(3),qo()})}if(2===e||1===e){const t=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),o=$o(t,X),a=yo(o);return void mo(Ge,a)}3===e&&(Ma(2),sa(2),ca(2),la(2),na(2),Da(),Ys(2),Qs(0),Zs())},sa=e=>{if(1===e){const e=go(Qe);mo(Je,e),bo(Qe,x,()=>{sa(3),qo()})}if(2===e||1===e){const t=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),o=$o(t,J),a=yo(o);return void mo(Qe,a)}3===e&&(Ma(3),ca(2),la(2),na(2),Da(),Ys(2),Qs(0),Zs())},ca=e=>{if(1===e){const e=go(We);mo(Xe,e),bo(We,x,()=>{ca(3),qo()})}if(2===e||1===e){const t=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),o=$o(t,W),a=yo(o);return void mo(We,a)}3===e&&(Ma(4),la(2),na(2),Da(),Ys(2),Qs(0),Zs())},ra=()=>Wt[to.get()],la=e=>{if(1===e){const e=go(Ze);vo(lt),mo(Ye,e),bo(Ze,x,()=>{Ma(5),wa(1),Ys(2),qo(),la(3),ss(1),Es(0),Aa(ra()),ks()})}if(2===e||1===e){const t=to.get(),o=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),a=$o(o,t);ao.set(a);const s=yo(ao.get());return void mo(Ze,s)}3===e&&(Ma(5),na(2),Da(),Ys(2),Qs(0),Xs(0),Zs(),ia())},na=e=>{if(1===e){const e=go(et);mo(Ke,e),bo(et,x,()=>{Ma(6),na(3),qo(),cs(1),ks()})}if(2===e||1===e){const t=1===e?Kt.get():2===e?eo.get():new Error(`${_e} ${e}`),o=$o(t,ee),a=yo(o);return void mo(et,a)}3===e&&(Ma(6),Da(),Ys(2),Qs(0),Zs(),ia())},ia=()=>{za(),Qa(),ac()},da=()=>{c.forEach((e,t)=>{const o=Co(E,ot,t,e,t);fo(tt,o),bo(`${ot}_${t}`,x,()=>{ts(1)})}),ho(`${ot}_${y}`).checked=1},$a=()=>{r.forEach((e,t)=>{const o=Co(E,st,t,e,t);fo(at,o)}),ho(`${st}_${S}`).checked=1},ha=()=>{const e=Co(E,rt,0,o[0],1),t=Co(E,rt,1,o[1],0);fo(ct,`${e}<div class="form-check"><div class="dropdown"><select class="form-select" aria-label="Default select example" id="${qt}"><option value="5">5</option><option value="10">10</option><option value="25">25</option><option value="50" selected>50</option><option value="75">75</option><option value="100">100</option></select></div></div>${t}`),ho(`${rt}_${y}`).checked=1},ua=()=>{s.forEach((e,t)=>{const o=Co(E,it,t,e,t);fo(nt,o)}),ho(`${it}_${y}`).checked=1},fa=()=>{t.forEach((e,t)=>{const o=t+1,a=Co(E,$t,o,e,o);fo(dt,a),bo(`${$t}_${o}`,x,()=>{as(1)})}),ho(`${$t}_${t.length}`).checked=1},ba=()=>{l.forEach((e,t)=>{const o=Co(M,ht,t,e,t);fo(mt,o),bo(`${ht}_${t}`,x,()=>{_a(),ga(),zo(),os(1)})}),ho(`${ht}_${S}`).checked=1},ma=()=>{n.forEach((e,t)=>{const o=Co(M,ut,t,e,t);fo(vt,o),bo(`${ut}_${t}`,x,()=>{Ca(t),ga(),zo(),os(1)})}),ho(`${ut}_${y}`).checked=1},va=()=>{i.forEach((e,t)=>{const o=Co(M,ft,t,e,t);fo(pt,o),bo(`${ft}_${t}`,x,()=>{ka(t),ga(),zo(),os(1)})}),ho(`${ft}_${y}`).checked=1},pa=()=>{d.forEach((e,t)=>{const o=Co(M,bt,t,e,t);fo(gt,o),bo(`${bt}_${t}`,x,()=>{xa(t),ga(),zo(),os(1)})}),ho(`${bt}_${y}`).checked=1},ga=()=>{xs(),ya()},ya=()=>{let e=k;const{p:{values:t}}=Gt;t.forEach((t,o)=>{const a=t.length>2?t.slice(0,t.length).join(", "):2===t.length?` ${t[1]}`:k;let s="";var c;t[0]!=$[2]&&(s=`Cargas académicas ${t[0]}${a}`),t[0]==$[2]&&(s=`${c=t[0],`${c[0].toUpperCase()}${c.substring(1).toLowerCase()}`} las cargas académicas ${a}`),s+=`: <spam id="${wt}_${o}"></spam>`;const r=Co(E,St,o,s,o);e+=r});mo(Ct,`<a name="${P}"></a><h6>5 - Selecione una métrica.</h6><p class="form-check-label">Mostrar seleccionado:</p><div class="form-check">${e}</div></div>`),t&&(ho(`${St}_${y}`).checked=1),t.forEach((e,t)=>{bo(`${St}_${t}`,x,()=>{rs(1)})})},Sa=e=>{const t=`${Co(E,kt,0,a[0],0)}${Co(E,kt,1,a[1],1)}${wo(Ot)}`;mo(_t,t),bo(`${kt}_${y}`,x,()=>{wa(0)}),bo(`${kt}_${S}`,x,()=>{wa(1)}),ho(`${kt}_${e}`).checked=1},wa=e=>{if(!e)return vo(xt),void Sa(0);let t=k;const o=Do();Xt.S.forEach(e=>{t+=`<tr><td style="background-color: ${e[0]}; color:${o?"#adb5bd":"#ffffff"}">${e[1]}</td></tr>`});mo(xt,`<table class="responsive"><thead><tr><th scope="col">Colores para las sesiones de las asignaturas</th></tr></thead><tbody>${t}</tbody></table>`),Sa(1);ra().forEach((e,t)=>{let o="";Xt.S.forEach((e,a)=>{o+=`<option style="background-color: ${e[0]}" ${a===t?"selected":k}>${e[1]}</option>`});fo(Ot,`<label class="form-check-label">Asignatura <br>${e}</label><select class="form-select" id="${Rt}_${t}">${o}</select>`)})},_a=()=>{ho(`${ht}_${S}`).checked||ho(`${ht}_${w}`).checked||(ho(`${ht}_${S}`).checked=1)},Ca=e=>{if(ho(`${ut}_${S}`).checked||ho(`${ut}_${w}`).checked)return 0===e?(ho(`${ut}_${y}`).checked=1,ho(`${ut}_${S}`).checked=0,void(ho(`${ut}_${w}`).checked=0)):void(1!==e&&2!==e||(ho(`${ut}_${y}`).checked=0));ho(`${ut}_${y}`).checked=1},ka=e=>{if(ho(`${ft}_${S}`).checked||ho(`${ft}_${w}`).checked)return 0===e?(ho(`${ft}_${y}`).checked=1,ho(`${ft}_${S}`).checked=0,void(ho(`${ft}_${w}`).checked=0)):void(1!==e&&2!==e||(ho(`${ft}_${y}`).checked=0));ho(`${ft}_${y}`).checked=1},xa=e=>{if(ho(`${bt}_${S}`).checked||ho(`${bt}_${w}`).checked){if(0===e)return ho(`${bt}_${y}`).checked=1,ho(`${bt}_${S}`).checked=0,ho(`${bt}_${w}`).checked=0,void vo(yt);if(1!==e){if(2===e){let e=[];if(e=ra(),0===e.length)throw alert(ye),ho(`${bt}_${S}`).checked&&(ho(`${bt}_${w}`).checked=0),ho(`${bt}_${S}`).checked||(ho(`${bt}_${y}`).checked=1),new Error(ye);return ho(`${bt}_${y}`).checked=0,void Aa(e)}}else ho(`${bt}_${y}`).checked=0}else ho(`${bt}_${y}`).checked=1},Aa=e=>{if(ho(`${bt}_${w}`).checked){let t=k;e.forEach((o,a)=>t+=`<option value=${a+1} ${e.length===a?"selected":k}>${a+1}</option >`);mo(yt,`<select class="form-select" id="${Lt}">${t}</select>`),bo(Lt,x,()=>{ls(1)})}else vo(yt)},Da=()=>{let e=[],t=[],o=[];const a=[];Gt._=1,ao.get().forEach(s=>{e=structuredClone(Wt),e[to.get()]=[s],t=Ya(Kt.get(),e),o=$o(t,ee),a.push(o.length)}),Gt._=a.reduce((e,t)=>e*t)},Ea=e=>Array.from(ho(e).selectedOptions).map(e=>e.textContent),Ma=e=>{const t=Ea(Ve),o=Ea(Ge),a=Ea(Qe),s=Ea(We);ao.set(Ea(Ze));const c=Ea(et);Wt[G]=t,Wt[X]=e>=2?o:[],Wt[J]=e>=3?a:[],Wt[W]=e>=4?s:[],Wt[to.get()]=e>=5?ao.get():[],Wt[ee]=e>=6&&e<=9?c:[],eo.set(Ya(Kt.get(),Wt))},qa=e=>{const t=uo(e);for(let e=0;e<t.length;e++)if(t[e].checked)return e},Na=e=>{const t=uo(e),o=[];for(let e=0;e<t.length;e++)t[e].checked&&o.push(e);return o},za=()=>{Xt.selected=[];const e=ra();for(let t=0;t<e.length;t++)Xt.selected.push(ho(`${Rt}_${t}`).selectedIndex)},Ta=()=>{Ra({C:1,k:0,A:qa(st)})},Ia=e=>{document.body.style.cursor=e},Ra=({C:e,k:t,A:o})=>{if(Ia(j),!(()=>{if(!Ja())return alert(ge),0;const{_:e}=Gt;return 0===e?(alert(Se),0):e>1881600?(alert(`El buscar ${Ws(e)} cargas académicas, conlleva un tiempo de espera superior a 10 segundos, tenga paciencia y concideración de esta situación`),1):1})())return void 0;Cs();const{l:a,D:s}=Gt,c=es(),r=c||a!==v&&(Ft.M||Ft[St]);so.set(Gt.p.q[qa(St)][0][1]),e&&((a===v||Ft.N)&&(Qa(),ds()),r&&(As(),s.length>0&&_s(),Es(1)),c&&Ss()),ns(),Ds()&&(e&&!t&&(Ps(0),Us(0),qa(rt)?(Vs(),Xs(0)):(Ps(1),Us(1),Rs(),Js(),To(),Fs(),Hs(),Xs(1)),Ys(3),Qs(1)),!e&&t&&(Xs(0),Js(),To(),Ts(),Ys(4)),o?(tc(),Os()):Xs(0),Ia(O))},La=e=>e.map(([,e,t])=>[e,t,"","","","","",""]),ja=()=>[...new Set(Kt.get().filter(e=>"A"===e[U]).map(e=>[e[ie],e[le],e[ne],e[ce],e[re],e[de],e[U]]).filter((e,t,o)=>{const a=e[2]+"|"+e[3];return o.findIndex(e=>e[2]+"|"+e[3]===a)===t}).sort((e,t)=>e[3]-t[3]))],Oa=(e,t,o,a,s)=>{let c=Uo(Ba(e));o&&(c+=g);const r=new Date(c),l=`${r.getHours()}:${Ba(r.getMinutes())}:${Ba(r.getSeconds())}`,n=c/g;c+=g*t;const i=new Date(c),d=`${i.getHours()}:${Ba(i.getMinutes())}:${Ba(i.getSeconds())}`,$=c/g,h=oo.get()(t),{i:u}=Ho(t,h),f=[t,l,d,n,$,u,a];return"C"===a&&f.push(s),f},Pa=e=>{const t=oo.get()()[0];for(let o=0;o<e.length;o++){const a=e[o],s=`${a[1]} - ${a[2]}`,c=a[5];if(c>1){let r=a[1];for(let a=0;a<c;a++){const c=Oa(r,t,a>0,"C",s);r=c[2],0==a&&e.splice(o,1);Ha(c,e,3,4)||(e.splice(o,0,c),o++)}o--}}Ua(e)},Ua=e=>{e.sort((e,t)=>e[3]-t[3]||e[4]-t[4])},Ba=e=>{const t=e.toString();return 1===t.length||7===t.length?"0"+t:t},Ha=(e,t,o,a)=>t.some(t=>t[o]===e[o]&&t[a]===e[a]),Va=e=>{for(let t=1;t<e.length;t++){const o=e[t],a=e[t-1],s=o[3]-1-(a[4]+1);if(s>9)throw new Error("Se detecta una ventana mayor a 9 minutos");if(s>-1){const o=a[2],c=Oa(o,s,!0,"CR");e.splice(t,0,c),t++}}},Fa=e=>{e.slice(1).forEach((t,o)=>{const a=e[o];t[3]-1!==a[4]&&console.log(" V:",`El elemento ${o+1} no es consecutivo con el anterior`,t)})},Ga=()=>{ro.set((()=>{const e=ja();return Pa(e),Va(e),Fa(e),La(e)})())},Ja=()=>Wt[G].length>0&&Wt[W].length>0&&Wt[to.get()].length>0,Qa=()=>{co.set([]);const e=to.get(),t=ro.get(),o=co.get(),a=Wt[e],s=a.length,c=[],r=[];for(let l=0;l<s;l++){const s={"Sección":[],Docente:k,Sala:k};s[e]=[a[l]];const n={T:s[e],N:[]};o.push(n);const i=o.length-1,d=Ya(eo.get(),s),$=$o(d,ee);for(let e=0;e<$.length;e++){const a=$[e];s[ee]=[a];const n=Ya(eo.get(),s),d={I:s[ee],R:$o(n,oe).join(", "),L:[],j:[],O:[[],[],[],[],[],[]]};o[i].N.push(d);const h=o[i].N,u=h[h.length-1],{j:f,O:v,L:p}=u;let g=[],y=[];if(g=Array.from(new Set(n.map(e=>e[te]))).map(e=>({Horario:e,"Día":n.find(t=>t[te]===e).Día})),g.length<=0&&alert(pe),2017!==lo.get()&&(y=g),2017===lo.get()){const t=g[0][te].split(_),a=g[0].Día.split(_);if(t.length===a.length)for(let e=0;e<t.length;e++)y.push({Horario:t[e],"Día":a[e]});else t.length<a.length?alert(`A la columna Horario de la sección ${o[l].N[e].I} le falta un horario.`):a.length<t.length&&alert(`A la columna Día de la sección ${o[l].N[e].I} le falta un día.`)}for(let a=0;a<y.length;a++){let s=3,r=1;const n=y[a],i=n[se],d=n[te];"En linea"!==i&&"Online"!==d||(s-=1,r-=1);const $=no.get()?i:d.split(" ")[0],h=d.split(" "),u={P:$,U:h[s],B:h[r],H:0,V:[]},{B:f,U:v,V:g}=u,S=no.get()?b.indexOf($):m.indexOf($);-1===S&&c.push(o[l].N[e].I),u.H=S;for(let e=0;e<t.length;e++){const o=t[e];if(o[0]===f){if(g.push(e),o[1]===v)break}else{if(o[1]===v){g.push(e);break}g.length>0&&g.push(e)}}p.push(u)}for(let e=0;e<p.length;e++){const{V:o,H:s,B:c,U:l}=p[e],n=o.map(e=>e+t.length*s);if(-1!==s)for(let o=0;o<p.length;o++){const{V:s,H:i,B:d,U:$}=p[o],h=s.map(e=>e+t.length*i);if(-1===i)continue;const u=new Set(n),f=new Set(h),b=u.difference(f).size>0,m=u.isSubsetOf(f),v=f.isSubsetOf(u);b&&m&&(r.push(`${a} ${c} ${l}`),p.splice(e,1)),b&&v&&(r.push(`${a} ${d} ${$}`),p.splice(o,1))}}for(let e=0;e<p.length;e++){const{V:o,H:a}=p[e];for(let e=0;e<o.length;e++){const s=o[e],c=t.length*a+s;f.push(c),v[a].push(s)}}}}c.length>0&&Wa(1,0,c),r.length>0&&Wa(1,1,r)},Xa=e=>`<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" /></symbol></svg><div class="alert alert-warning alert-dismissible fade show" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:"><use xlink:href="#exclamation-triangle-fill" /></svg>${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`,Wa=(e,t,o=[])=>{const a=[Te,Ie];if(!e)return void mo(a[t],k);if(!Array.isArray(o)||0===o.length)return void mo(a[t],Xa("No hay información para mostrar."));const s=[`<strong>Un día no asignado en el excel para ${o.length>1?"las secciones: ":"la sección: "}</strong>${o.join(" - ")}. Revise en la columna "Día" del Excel su correspondiente valor, tiene que ser con nombres de Lunes a Sábado. Al faltarle un día a la sección no se mostrará en la tabla, pero sí se considera en las combinaciones de la lista.`,`<strong>${o.length>1?"Las secciones: ":"La sección: "}</strong>${o.join(" - ")}${o.length>1?" tienen horarios duplicados y por ello se han eliminado.":" tiene un horario duplicado y por ello se ha eliminado."}`];mo(a[t],Xa(s[t]))},Ya=(e,t)=>e.filter(e=>Object.keys(t).every(o=>Array.isArray(t[o])&&t[o].some(t=>"string"==typeof e[o]&&e[o]===t)||0===t[o].length)),Za=()=>Ka()?6:5,Ka=()=>Wt[X].some(e=>"Vespertino"===e||"Diurno y Vespertino"===e),es=()=>Ft.order||Ft.F||Ft.subject||Ft.N||Ft[bt],ts=e=>{Ft.order=e},os=e=>{Ft.F=e},as=e=>{Ft.M=e},ss=e=>{Ft.subject=e},cs=e=>{Ft.N=e},rs=e=>{Ft[St]=e},ls=e=>{Ft[bt]=e},ns=()=>{ts(0),os(0),rs(0),as(0),ss(0),ls(0)},is=(e,t)=>{const o={},a=((e,t)=>{const o=[];for(let a=t.length-1;a>=0;a--){const s=t[a],c=e%s;o.unshift(c);const r=e/s;e=Math.floor(r)}return o})(e,t);o.G=a;const{J:s,X:c}=(e=>{const t=[],o=[];for(let a=0;a<e.length;a++){const s=e[a],{j:c,O:r}=co.get()[a].N[s];t.push(c),o.push(r)}return{J:t,X:o}})(a);return o.J=s,o.X=c,o},ds=()=>{Gt.o=new Array(Gt._)},$s=()=>co.get().map(e=>e.N.length),hs=e=>{const t=e.J.flat();e[ht]=t.length===[...new Set(t)].length?1:0},us=e=>{const t=[[],[],[],[],[],[]],o=[[],[],[],[],[],[]],a=[0,0,0,0,0,0],{X:s}=e;for(let e=0;e<t.length;e++)for(let c=0;c<s.length;c++)if(s[c][e].length>0){const r=[];for(let t=0;t<s[c][e].length;t++)o[e].includes(s[c][e][t])||r.push(s[c][e][t]),o[e].push(s[c][e][t]);t[e]=t[e].concat([r.sort((e,t)=>e-t)]),a[e]++}for(let e=0;e<t.length;e++){o[e].sort((e,t)=>e-t);for(let o=0;o<t[e].length;o++)t[e]=t[e].sort((e,t)=>e[e.length-1]-t[0])}e.W=t,e.Y=o,e.Z=a},fs=e=>{let t=1;const o=(()=>{if(null===ho(Lt))return ao.get().length>4?Ka()?ao.get().length:4:ao.get().length;return ho(Lt).value})(),{Z:a}=e;for(let e=0;e<a.length;e++)if(a[e]>o){t=0;break}e[bt]=t},bs=(e,t)=>{Gt.o[t]={}},ms=(e,t)=>{Gt.o[t].K=e.X.flat(2).reduce((e,t)=>e+t,0)},vs=e=>{const t=[],o=[0,0,0,0,0,0],a=[0,0,0,0,0,0],{W:s,Y:c}=e;for(let e=0;e<s.length;e++)if(0!=s[e].length){t.push(e);const a=s[e];for(let t=1;t<a.length;t++)a[t-1][a[t-1].length-1]!==a[t][0]-1&&o[e]++}for(let e=0;e<c.length;e++){const t=c[e],o=t.length,s=t[0],r=t[o-1]-s+1-o|0;a[e]=r}e.ee=t,e.te=o,e.oe=a},ps=e=>{e[ut]=e.ee.length<Za()?1:0},gs=(e,t)=>{Gt.o[t].ae=e.oe.reduce((e,t)=>e+t,0)},ys=e=>{const{ee:t,te:o,W:a}=e;let s=0;for(let e=0;e<t.length;e++)o[t[e]]===a[t[e]].length-1&&s++;e[ft]=s===t.length?1:0},Ss=()=>{const e=qa(ot),t=Ns();if(0===e)return void t.sort((e,t)=>e-t);Gt.l!==v&&(e=>{const t=$s(),{o:o}=Gt;Ns().forEach(a=>{o[a]==v&&(o[a]={});const{K:s,ae:c}=Gt.o[a],r=is(a,t);1!==e&&2!==e||s!=v||ms(r,a),3!==e&&4!==e||c!=v||(us(r),vs(r),gs(r,a))})})(e);const{o:o}=Gt;1!==e?2!==e?3!==e?4!==e||t.sort((e,t)=>o[t].ae-o[e].ae):t.sort((e,t)=>o[e].ae-o[t].ae):t.sort((e,t)=>o[t].K-o[e].K):t.sort((e,t)=>o[e].K-o[t].K)},ws=()=>{const e=qa(ot),{p:{se:t,q:o},D:a}=Gt,s=[];for(let e=0;e<a.length;e++){const t=o[a[e]];for(let e=0;e<t.length;e++){const o=t[e][0];s.includes(o)||s.push(o)}}const c=[];return s.includes(ht)&&c.push(hs),c.push(us),s.includes(bt)&&(t[bt].includes(1)||t[bt].includes(2))&&c.push(fs),e>0&&c.push(bs),1!==e&&2!==e||c.push(ms),(s.includes(ut)&&(t[ut].includes(1)||t[ut].includes(2))||3===e||4===e||s.includes(ft)&&(t[ft].includes(1)||t[ft].includes(2)))&&c.push(vs),s.includes(ut)&&(t[ut].includes(1)||t[ut].includes(2))&&c.push(ps),3!==e&&4!==e||c.push(gs),s.includes(ft)&&(t[ft].includes(1)||t[ft].includes(2))&&c.push(ys),c},_s=()=>{const e=$s(),{D:t,p:{q:o,ce:a},_:s,re:c}=Gt,r=ws();for(let l=0;l<s;l++){const s=is(l,e);for(let e=0;e<r.length;e++)r[e](s,l);t.forEach(e=>{let t=1;o[e].forEach(e=>{2!==e[1]&&(s[e[0]]===e[1]||(t=0))}),t&&c[a[e]].push(l)})}},Cs=()=>{Gt.D=[]},ks=()=>{Gt.re={}},xs=()=>{ks(),Gt.p={};const{p:e}=Gt;e.ce=[],e.q=[],e.values=[],e.se={};const{se:t}=e;t[ht]=Na(ht),t[ut]=Na(ut),t[ft]=Na(ft),t[bt]=Na(bt);const{re:o}=Gt;t[ht].forEach(a=>{const s=[ht,a],c="S"+Ms(a);e.ce.push(c),e.q.push([s]),e.values.push([$[a]]),o[c]=v,t[ut].forEach(t=>{const r=t-1;if(-1!==r){const t="SFD"+Ms(r),l=`${c}-${t}`;e.ce.push(l),e.q.push([s,[ut,r]]),e.values.push([$[a],h[r]]),o[l]=v}}),t[ft].forEach(t=>{const r=t-1;if(-1!==r){const t="MOF"+Ms(r),l=`${c}-${t}`;e.ce.push(l),e.q.push([s,[ft,r]]),e.values.push([$[a],u[r]]),o[l]=v}}),t[bt].forEach(t=>{const r=t-1;if(-1!==r){const t="SOM"+Ms(r),l=`${c}-${t}`;e.ce.push(l),e.q.push([s,[bt,r]]),e.values.push([$[a],f[r]]),o[l]=v}})})},As=()=>{const e=qa(St),t=(o=$t,parseInt(uo(o)[qa(o)].value));var o;const{p:{ce:a},re:s,D:c}=Gt;a.forEach((o,a)=>{3===t&&e!==a&&(s[o]=v),1!==t&&(2!==t&&3!==t||e!==a)||(s[o]===v||Ft[bt]&&(o.includes(bt)||o.includes("SOM")))&&(s[o]=[],c.push(a))})},Ds=()=>Ns()===v?1:0===zs()?(Zs(),null!==ho(At)&&vo(At),0):1,Es=e=>{const{p:{ce:t},re:o}=Gt;t.forEach((a,s)=>{const c=e?o[t[s]]?Ws(o[t[s]].length):"?":k;mo(`${wt}_${s}`,c)})},Ms=e=>{if(1===e){return"_T"}if(0===e){return"_F"}if(2===e){return"_A"}},qs=e=>{{const t={};return t[ht]=so.get(),{...is(e,$s()),...t}}},Ns=()=>{const{re:e,p:{ce:t}}=Gt;return e[t[Na(St)]]},zs=()=>Ns().length,Ts=()=>{const e=ho(At);if(null==e)return alert(ke),0;const t=Array.from(e.selectedOptions).map(e=>parseInt(e.value));return 0==t.length?(alert(xe),0):(Gt.l=t,1)},Is=e=>{const t=Math.trunc(Jt.le/e),o=Jt.le%e,a=[];for(let o=0;o<t;o++)a.push([o*e,o*e+e,0]);return o>0&&a.push([t*e,t*e+o,0]),a},Rs=()=>{const e=parseInt(Ea(qt));Jt.le=zs(),Jt.ne=Is(e),Jt.le>p&&(Qt.ne=Is(p))},Ls=e=>{0!==Jt.ie||e?Jt.ne.length===Jt.ie+1&&e?alert(ko(I,R)):(Ia(j),e?Jt.ie++:Jt.ie--,To(),Hs(),Xs(1),Jt.ne[Jt.ie][2],tc(),Fs(),Os(),Ia(O)):alert(ko(T,R))},js=e=>{0!==Qt.ie||e?Qt.ne.length===Qt.ie+1&&e?alert(ko(I,L)):(Ia(j),e?Qt.ie++:Qt.ie--,Gs(),Ys(3)):alert(ko(T,L))},Os=()=>{const e=Jt.ie!=v?`_${Jt.ie}`:k;location.hash="#"+(0===Jt.ie?`${P}`:`${Re}${e}`)},Ps=e=>{Jt.ie=e?0:v},Us=e=>{Qt.ie=e?0:v},Bs=()=>{Jt.ie=ho(Nt).selectedIndex},Hs=()=>{const e=Jt.ne[Jt.ie][0],t=Jt.ne[Jt.ie][1];Jt.de=e,Jt.$e=t,Gt.l=Ns().slice(e,t)},Vs=()=>{Gt.l=Gt.o.map((e,t)=>t)},Fs=()=>{Jt.ne[Jt.ie][2]=1},Gs=()=>{Qt.ne[Qt.ie][2]=1},Js=()=>{let e=k;for(let t=0;t<Jt.ne.length;t++)e+=`<div id="${Re}_${t}"></div>`;mo(`${Re}`,e)},Qs=e=>{mo(Mt,e?'<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfaidqhUi9_qqaiSjIAhwFQrCHji_-459KmzP3uibq1d1Z1Ow/viewform?embedded=true" width="500" height="443" frameborder="0" marginheight="0" marginwidth="0">Cargando…</iframe>':k)},Xs=e=>{if(e){let e=k;for(let t=0;t<Jt.ne.length;t++)e+=`<option ${Jt.ie===t?"selected":k}>${Ws(t+1)}: ${Ws(Jt.ne[t][0]+1)} al lugar ${Ws(Jt.ne[t][1])}</option>`;const t=`<div><h6>Rangos de cargas académicas</h6><div class="d-grid mx-auto"><spam> Total de rangos: ${Ws(Jt.ne.length)}</spam><spam> Total de cargas académicas: ${Ws(Jt.le)}</spam><spam> Rango actual: </spam><select class="form-select" aria-label="Default select example" id="${Nt}">${e}</select><div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${zt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${zt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div></div>`;mo(ze,t),ho(ze).classList.add("shadow-lg","mb-5",Do()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2"),bo(Nt,x,()=>{Bs(),Hs(),Xs(1),Jt.ne[Jt.ie][2]?alert(`Ya se ha desplegado el rango ${Jt.ie+1}.`):tc(),Os(),Fs(),Ia(O)}),bo(`${zt}_${y}`,A,()=>{Ls(0)}),bo(`${zt}_${S}`,A,()=>{Ls(1)})}else vo(ze),ho(ze).classList.remove("shadow-lg","mb-5",Do()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2")},Ws=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".").toString(),Ys=e=>{if(1==e)return vo(Ne),vo(Me),vo(Te),vo(Ie),void Yo(0);if(2==e){const e=`<h6>Métricas:</h6><div class="form-check"><p class="form-check-label">Cargas académicas a buscar: ${Ws(Gt._)}</p></div>`;return mo(Me,e),mo(Dt,e),vo(Te),vo(Ie),vo(Et),void vo(Ne)}if(3==e){let e=k;Qt.ne&&(e=`<div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${Tt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${Tt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div>`);let t=k;Qt.ne&&(t=`Rango: <text class="form-check-label">${Qt.ie+1} de ${Qt.ne.length}</text>`);const o=`<a href="#${P}" class="btn btn-outline-primary flotante ${Do()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;mo(Ne,o);const a=go(At);mo(Et,`<h6>Número/s de carga/s académica/s (Selección opcional)</h6><text class="form-check-label">Color azul: Cargas académicas aprobadas</text><br><text class="form-check-label">Color rojo: Cargas académicas rechazadas</text><br>${t}<div>${a}</select><div class="margen d-grid">${e}<button type="button" class="btn btn-secondary" id="${It}">${Ce}</button></div></div></div>`),Qt.ne&&(bo(`${Tt}_${y}`,A,()=>{js(0)}),bo(`${Tt}_${S}`,A,()=>{js(1)})),bo(`${It}`,A,()=>{Ra({C:0,k:1,A:1})}),vo(At);let s=[];if(Qt.ne){if(0===Qt.ne.length)return console.alert(we);s=(()=>{const e=Qt.ne[Qt.ie][0],t=Qt.ne[Qt.ie][1];return Qt.de=e,Qt.$e=t,Ns().slice(e,t)})()}else s=Ns();0;{const e=so.get()?he:fe;s.forEach(t=>{const o=`<option style="color:${e}" value=${t}>${Ws(t+1)}</option>`;fo(At,o)})}return}if(4==e){const e=`<a href="#${P}" class="btn btn-outline-primary flotante ${Do()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;return void mo(Ne,e)}},Zs=()=>{Xs(0),Ks()},Ks=()=>{vo(Re)},ec=e=>{const t=Jt.ie!=v?`_${Jt.ie}`:k;fo(`${Re}${t}`,e)},tc=()=>{const e=qa(it),t=qa(kt);0!==e?1!==e?2!==e?3!==e?4!==e||(t?(za(),bc()):fc()):t?dc():$c():t?nc():ic():t?(za(),lc()):rc():t?(za(),cc()):sc()},oc=()=>{Xt.S=[["#ffdf89","Anaranjado"],["#fffdbf","Amarillo"],["#e9ffba","Verde limón"],["#defefe","Turquesa"],["#cff4fc","Celeste"],["#cfe2ff","Azúl"],["#e2d9f3","Purpura"],["#e0cffc","Indigo"],["#f7d6e6","Rosado"],["#e8ba86","Marrón"],["#d3bead","Café"],["#f8f9fa","Plomo"]]},ac=()=>{let e=k;const t=structuredClone(ro.get());for(let o=0;o<t.length;o++){const a=t[o];e+=`<tr><th scope="row">${a[0]} - ${a[1]}</td><td>${a[2]}</td><td>${a[3]}</td><td>${a[4]}</td><td>${a[5]}</td><td>${a[6]}</td><td>${a[7]}</td></tr>`}mo(lt,`<div class=""><table class="table table-bordered"><caption><h5></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${e}</tbody></table><a class="btn btn-outline-info" data-bs-toggle="collapse" href="#${Pt}" role="button" aria-expanded="false" aria-controls="${Pt}">Mostrar o no todas las secciones juntas</a></div>`);const o=ho(lt).firstElementChild.getElementsByTagName("table")[0],a=Do();for(let e=0;e<co.get().length;e++){const t=co.get()[e],s=t.T,c=Xt.S[Xt.selected[e]][0];for(let e=0;e<t.N.length;e++){const r=t.N[e],l=r.I;for(let e=0;e<r.L.length;e++){const t=r.L[e],n=t.H;for(let e=0;e<t.V.length;e++){const r=t.V[e];o.rows[r+1].cells[n+1].insertAdjacentHTML(D,`<span class="badge" style="background-color:${c}; color:${a?"#adb5bd":"#ffffff"}">${s.toString().replaceAll(" ","<br>")}<br>${l}</span>`)}}}}},sc=()=>{let e=k;const{l:t}=Gt;for(let o=0;o<t.length;o++){const a=qs(t[o]);let s=structuredClone(ro.get());for(let e=0;e<a.G.length;e++){const t=co.get()[e].N[a.G[e]];let o=t.I[0];for(let e=0;e<t.L.length;e++){const a=t.L[e];let c=a.H;for(let e=0;e<a.V.length;e++)s[a.V[e]][c+2]+=` ${o}`}}let c=k;for(let e=0;e<s.length;e++)c+=`<tr><th scope="row">${s[e][0]} - ${s[e][1]}</th><td>${s[e][2]}</td><td>${s[e][3]}</td><td>${s[e][4]}</td><td>${s[e][5]}</td><td>${s[e][6]}</td><td>${s[e][7]}</td></tr>`;const r=a[ht]?`<p style="color:${he}">Carga académica ${Ws(t[o]+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(t[o]+1)} rechazada</p>`;e+=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${r}<div class="margen"><button type="button" class="btn btn-${a[ht]?"primary":"danger"}" id="${jt}${t[o]}" data-bs-toggle="modal" data-bs-target="#${Ut}${t[o]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${c}</tbody></table></div><div class="modal fade" id="${Ut}${t[o]}" tabindex="-1" aria-labelledby="${Bt}" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="${Bt}${t[o]}">${r}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${t[o]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div>`}ec(e);for(let e=0;e<t.length;e++)bo(`${jt}${t[e]}`,A,()=>{hc(t[e])})},cc=()=>{let e=k;const t=co.get(),{l:o}=Gt,a=Do();for(let s=0;s<o.length;s++){const c=qs(o[s]);let r=structuredClone(ro.get()),l=structuredClone(ro.get());for(let e=0;e<c.G.length;e++){const o=t[e].T,a=t[e].N[c.G[e]],s=a.I[0];for(let t=0;t<a.L.length;t++){const c=a.L[t],n=c.H;for(let t=0;t<c.V.length;t++){const a=c.V[t];l[a][n+2]=l[a][n+2].length>0?ue:Xt.S[Xt.selected[e]][0],r[a][n+2]+=` ${o.toString().replaceAll(" ","<br>")} <b>${s}</b>`}}}let n=k;for(let e=0;e<r.length;e++)n+=`<tr><th scope="row">${r[e][0]} - ${r[e][1]}</th><td><span class="badge" style="background-color:${l[e][2]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][2]}</span></td><td><span class="badge" style="background-color:${l[e][3]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][3]}</span></td><td><span class="badge" style="background-color:${l[e][4]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][4]}</span></td><td><span class="badge" style="background-color:${l[e][5]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][5]}</span></td><td><span class="badge" style="background-color:${l[e][6]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][6]}</span></td><td><span class="badge" style="background-color:${l[e][7]}; color:${a?"#adb5bd":"#ffffff"}">${r[e][7]}</span></td></tr>`;const i=c[ht]?`<p style="color:${he}">Carga académica ${Ws(o[s]+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(o[s]+1)} rechazada</p>`;e=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${i}<div class="margen"><button type="button" class="btn btn-${c[ht]?"primary":"danger"}" id="drawResumeColor${o[s]}" data-bs-toggle="modal" data-bs-target="#${Ut}${o[s]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${n}</tbody></table></div><div class="modal fade" id="${Ut}${o[s]}" tabindex="-1" aria-labelledby="${Bt}" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="${Bt}${o[s]}">${i}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${o[s]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div><hr/>`,ec(e),bo(`drawResumeColor${o[s]}`,A,()=>{uc(o[s])})}},rc=()=>{let e=k;const{l:t}=Gt;for(let o=0;o<t.length;o++){const a=qs(t[o]);let s=k;for(let e=0;e<a.G.length;e++){let t=k;const o=a.G[e],c=co.get()[e],r=c.T,l=c.N[o],n=l.I[0],i=l.R;for(let e=0;e<l.L.length;e++){const{P:o,B:a,U:s}=l.L[e];t+=`${o} ${a} - ${s} `}s+=`<tr><th scope="row">${r}</th><td>${n}</td><td>${i}</td><td>${t}</td></tr>`}e+=`<div class="table-responsive"><table class="table"><caption><h5>${a[ht]?`<p style="color:${he}">Carga académica ${Ws(t[o]+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(t[o]+1)} rechazada</p>`}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${s}</tbody></table></div`}ec(e)},lc=()=>{const{l:e}=Gt;for(let t=0;t<e.length;t++){const o=qs(e[t]),a=structuredClone(ro.get());let s=k;const c=[];for(let r=0;r<o.G.length;r++){let l=k;const n=co.get()[r],{T:i,N:d}=n,$=d[o.G[r]],h=$.I[0],u=$.R;c.push(Xt.S[Xt.selected[r]][0]);for(let e=0;e<$.L.length;e++){const t=$.L[e],o=t.H;for(let e=0;e<t.V.length;e++){const s=t.V[e];a[s][o+2]!=k&&(c[a[s][o+2]]=ue,c[r]=ue),a[s][o+2]=`${r}`}l+=`${t.P} ${t.B} - ${t.U} `}s+=`<tr><th scope="row">${i}</th><td id="${e[t]}-${r}">${h}</td><td>${u}</td><td>${l}</td></tr>`}const r=o[ht]?`<p style="color:${he}">Carga académica ${Ws(e[t]+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(e[t]+1)} rechazada</p>`;ec(`<div class="table-responsive"><table class="table"><caption><h5>${r}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${s}</tbody></table></div`);for(let o=0;o<c.length;o++)ho(`${e[t]}-${o}`).style.background=c[o]}},nc=()=>{alert("No se ha implementado la lista en tabla en color.")},ic=()=>{let e=k;const{l:t}=Gt;for(let o=0;o<t.length;o++){const a=qs(t[o]);let s=" Asignatura - Sección - Días y horas<br>";for(let e=0;e<a.G.length;e++){let t=k;const o=co.get()[e],c=o.T,r=o.N[a.G[e]],l=r.I[0];for(let e=0;e<r.L.length;e++){const{P:o,B:a,U:s}=r.L[e];t+=`${o}-${a} - ${s} `}s+=`${c} - ${l} - ${t}<br>`}e+=`${a[ht]?`<p style="color:${he}">Horario ${Ws(t[o]+1)} aprobada</p>`:`<p style="color:${fe}">Horario ${Ws(t[o]+1)} rechazada</p>`}${s}<br>`}ec(e)},dc=()=>{let e=k;const{l:t}=Gt;for(let o=0;o<t.length;o++){const a=qs(t[o]);let s=k;for(let e=0;e<ao.get().length;e++){s+=`${co.get()[e].N[a.G[e]].I[0]} `}e+=`${a[ht]?`<p style="color:${he}">Carga académica ${Ws(t[o]+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(t[o]+1)} rechazada</p>`}: ${s}<br>`}ec(e)},$c=()=>{let e=k;const{l:t}=Gt;for(let o=0;o<t.length;o++){const a=qs(t[o]);let s=k;for(let e=0;e<ao.get().length;e++){s+=`${co.get()[e].N[a.G[e]].I[0]} `}e+=`Carga académica ${Ws(t[o]+1)}: ${s}<br>`}ec(e)},hc=e=>{const t=qs(e);let o=k;for(let e=0;e<t.G.length;e++){const a=co.get()[e],s=a.T,c=a.N[t.G[e]],r=c.I[0],l=c.R;let n=k;for(let e=0;e<c.L.length;e++){const{P:t,B:o,U:a}=c.L[e];n+=`${t} ${o} - ${a} `}o+=`<tr><th scope="row">${s}</th><td>${r}</td><td>${l}</td><td>${n}</td></tr>`}const a=t[ht]?`<p style="color:${he}">Carga académica ${Ws(e+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(e+1)} rechazada</p>`;mo(`modal${e}`,`<div class="table-responsive"><table class="table"><caption><h5>${a}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${o}</tbody></table></div`)},uc=e=>{const t=qs(e),o=structuredClone(ro.get());let a=k;const s=[];for(let c=0;c<t.G.length;c++){let r=k;const{T:l,N:n}=co.get()[c],{I:i,R:d,L:$}=n[t.G[c]],h=i[0];s.push(Xt.S[Xt.selected[c]][0]);for(let e=0;e<$.length;e++){const{H:t,V:a,P:l,B:n,U:i}=$[e],d=t;for(let e=0;e<a.length;e++){const t=a[e];o[t][d+2]!=k&&(s[o[t][d+2]]=ue,s[c]=ue),o[t][d+2]=`${c}`}r+=`${l} ${n||"?"} - ${i||"?"} `}a+=`<tr><th scope="row">${l}</th><td id="${e+1}-${c}">${h}</td><td>${d}</td><td>${r}</td></tr>`}const c=t[ht]?`<p style="color:${he}">Carga académica ${Ws(e+1)} aprobada</p>`:`<p style="color:${fe}">Carga académica ${Ws(e+1)} rechazada</p>`;mo(`modal${e}`,`<div class="table-responsive"><table class="table"><caption><h5>${c}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${a}</tbody></table></div`);for(let t=0;t<s.length;t++)ho(`${e+1}-${t}`).style.background=s[t]},fc=()=>{let e=k;const t=co.get();for(let o=0;o<t.length;o++){const{T:a,N:s}=t[o];for(let t=0;t<s.length;t++){const{I:o,R:c,L:r}=s[t];let l=k;const n=o[0];for(let e=0;e<r.length;e++){const{P:t,B:o,U:a}=r[e];l+=`${t} ${o} - ${a} `}e+=`<tr><th scope="row">${a}</th><td>${n}</td><td>${c}</td><td>${l}</td></tr>`}}ec(`<div class="table-responsive"><table class="table"><caption><h5><p style="color:${he}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`)},bc=()=>{let e=k;const t=[],o=co.get();for(let a=0;a<o.length;a++){const{T:s,N:c}=o[a];t.push(Xt.S[Xt.selected[a]][0]);for(let t=0;t<c.length;t++){const{I:o,R:r,L:l}=c[t];let n=k;const i=o[0];for(let e=0;e<l.length;e++){const{P:t,B:o,U:a}=l[e];n+=`${t} ${o||"?"} - ${a||"?"} `}e+=`<tr><th scope="row">${s}</th><td name="_${a}">${i}</td><td>${r}</td><td>${n}</td></tr>`}}ec(`<div class="table-responsive"><table class="table"><caption><h5><p style="color:${he}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`);for(let e=0;e<t.length;e++)uo(`_${e}`).forEach(o=>o.style.background=t[e])};