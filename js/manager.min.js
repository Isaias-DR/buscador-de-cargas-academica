const e=["1 - Elija un documeto Excel.","2 - Seleccione la hoja que contenga los datos para la toma de ramos, ejemplo: Asignaturas, Horarios o Profesor.","3 - Seleccione los valores de los filtros.","4 - Seleccione las caracteristicas de como se mostraran para cada horario."],t=["Completo","Progresivo","Único"],o=["Por rangos de","Todos los horarios"],a=["No","Si"],s=["Carga académica semanal","Resumen de carga académica","Resumen de carga académica en texto","Lista simple de cargas académica","Carga académica semanal con resumen de sesiones"],c=["Sin ordenar","De los más cercanos a las 8 horas","De los más cercanos a las 23 horas","De los que tienen más ventanas a los que tienen menos","De los que tienen menos ventanas a los que tienen más"],l=["Métricas","Métricas + Selección"],r=["Rechazadas","Aprobadas","Todos"],n=["Ninguno","Sin día libre","Con día libre"],i=["Ninguno","Sin alguna ventana","Con ventana"],d=["Ninguno","Fuera del máximo de asignatura","Dentro del máximo de asignatura"],$=["rechazadas","aprobadas","todas"],h=["sin día libre","con día libre"],u=["que le falte alguna ventana","con todas las ventana"],m=["fuera del máximo de asignatura","dentro del máximo de asignatura"],b=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],f=["Lu","Ma","Mi","Ju","Vi","Sa"],v=void 0,p=1e5,g=6e4,y="0",S="1",w="2",_=" / ",C="margen",x="",k="change",A="click",D="beforeend",M="radio",E="checkbox",q="sin definir",L="online",z="no aplica",T="primeros",I="últimos",N="selección",R="lista",j="wait",O="default",P="metricas",U="Q",B="Año",H="Período",V="Sede",F="Escuela",G="Carrera",J="Plan",Q="Tipo Plan de Estudio",X="Jornada",W="Nivel",Y="Asignatura",Z="Asignatura en malla",K="Sección",ee="Horario",te="Docente",oe="Sala",ae="Día",se="Inicia",ce="Termina",le="Start",re="End",ne="Duración",ie="Grupos",de="Queda",$e="#48a3ff",he="#f8d7da",ue="#ff0000",me="0:00:00",be=`${me} - ${me}`,fe="Excel con mas datos de los nesesarios.",ve="La sección no presenta un mínimo de un horario para trabajar, por ello no podra visualizar las asignaturas en pantalla.",pe="Seleccione todos los filtros requeridos: Carrera, Jornada, Semestres y Asignaturas",ge="Debe elegir al menos una asignatura para elegir un máximo de asignatura por día.",ye="Debe seleccionar almenos una sección de cada asignatura que eligió",Se="No hay rangos númericos que mostrar.",we="No se considera el valor",_e="Mostrar carga/s académica/s seleccionada/s",Ce=`Tiene que haber dado click en el botón "${_e}".`,xe="Selecciones una carga académica que quiera ver.",ke="div_ejemplo",Ae="div_container",De="2",Me="4",Ee="10",qe="11",Le="12",ze="13",Te="14",Ie="15",Ne="16",Re="17",je="18",Oe="19",Pe="20",Ue="21",Be="22",He="23",Ve="24",Fe="25",Ge="26",Je="27",Qe="28",Xe="29",We="30",Ye="31",Ze="32",Ke="33",et="34",tt="35",ot="36",at="37",st="38",ct="39",lt="40",rt="41",nt="42",it="43",dt="44",$t="45",ht="46",ut="47",mt="48",bt="49",ft="50",vt="51",pt="52",gt="53",yt="54",St="55",wt="56",_t="57",Ct="58",xt="59",kt="60",At="61",Dt="62",Mt="63",Et="64",qt="65",Lt="66",zt="67",Tt="68",It="69",Nt="70",Rt="71",jt="72",Ot=Symbol(),Pt={},Ut={},Bt={},Ht={},Vt={},Ft={},Gt={},Jt=()=>{let e;return{t:t=>{e===v&&(e=t)},get:()=>e,set:t=>{e=t}}},Qt=Jt(),Xt=Jt(),Wt=Jt(),Yt=Jt(),Zt=Jt(),Kt=Jt(),eo=Jt(),to=Jt(),oo=Jt(),ao=Jt(),so=(Jt(),Jt()),co=(Jt(),()=>{"function"!=typeof Set.prototype.isSubsetOf&&(Set.prototype.isSubsetOf=function(e){for(const t of this)if(!e.has(t))return!1;return!0}),"function"!=typeof Set.prototype.difference&&(Set.prototype.difference=function(e){const t=new Set;for(const o of this)e.has(o)||t.add(o);return t})}),lo=(e,t)=>[...new Set(e.map(e=>e[t]))],ro=e=>document.getElementById(e),no=e=>document.getElementsByName(e),io=(e,t)=>{ro(e).insertAdjacentHTML(D,t)},$o=(e,t,o)=>{ro(e).addEventListener(t,o)},ho=(e,t)=>{ro(e).innerHTML=t},uo=e=>{ho(e,x)},mo=(e,t)=>e.hasOwnProperty(t),bo=e=>`<select multiple class="form-control" id="${e}" size="8"></select>`,fo=e=>`<option>${e.sort().join("</option><option>")}</option>`,vo=e=>`<h6>${e}</h6>`,po=e=>`<div id="${e}"></div>`,go=(e,t)=>`<div class="${e}" id="${t}"></div>`,yo=(e,t,o,a,s)=>`<div class="form-check"><input class="form-check-input" type="${e}" name="${t}" id="${t}_${o}" value="${s}" ><label class="form-check-label">${a}</label></div>`,So=(e,t)=>`Ya esta viendo las ${e} cargas académicas de la ${t}.`,wo=()=>{oo.set(v)},_o=e=>{const t=e.target.files;if(0===t.length)return void alert(`Aunque no haya seleccionado un archivo excel se mantienen los datos de ${Pt[Ot]}`);if(t.length>1)return console.warn(fe);const o=t[0];Pt[Ot]=o.name;const a=new FileReader;a.onload=e=>{const t=e.target.result;Qt.set(XLSX.read(t,{type:"binary"})),Wo(1),qo(1),Xo(0),Js(1),Yo(0),Qs(),Ga(0,0)},a.onerror=e=>{console.warn(e)},a.readAsBinaryString(o)},Co=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,xo=e=>{const t=e?"dark":"light";var o;e&&(o="html",document.querySelector(o)).setAttribute("data-bs-theme","dark");io(ke,`<img src="img/ejemplo ${t}.png" class="img-fluid" alt="Imagen de ejemplo del contenido que puede tener un Archibo Ecxel" >`)},ko=()=>{const t=`<div class="mb-3"><label for="formFile" class="form-label">${vo(e[0])}</label><input class="form-control" id="${Ne}" name="files[]" type="file"></div>`;ho("1",t),$o(Ne,k,_o)},Ao=(co(),xo(Co()),(()=>{const e=go(C,"1")+go(C,De)+go(C,"3")+go(C,Me)+go(C,"6")+go(C,"5")+go(C,"7")+go(C,"8")+go(C,"9")+go(C,Ee)+go(C,qe)+go("p-2",Le)+go(C,ze)+go(C,Te)+go(C,Ie);io(Ae,e)})(),ko(),r.splice(2,1),()=>{Do(),Mo()}),Do=()=>{delete Bt.o},Mo=()=>{delete Bt.l},Eo=()=>{Bt.l=[]},qo=t=>{if(!t)return void uo(De);const o=`${vo(e[1])}`;ho(De,o),Qt.get().SheetNames.forEach((e,t)=>{const o=yo(M,Re,t,e,e);io(De,o),$o(`${Re}_${t}`,k,Lo)})},Lo=async e=>{Gt[B]=[],Gt[H]=[],Gt[V]=[],Gt[F]=[],Gt[G]=[],Gt[J]=[],Gt[Q]=[],Gt[X]=[],Gt[W]=[],Gt[Y]=[],Gt[Z]=[],Gt[K]=[],Gt[ee]=[],Gt[te]=[],Gt[oe]=[],Gt[ae]=[],No(e),(()=>{if(so.set(mo(Xt.get()[0],ae)),!mo(Xt.get()[0],ee))Wo(1),Xo(0),Js(1),Yo(0),Qs(),Ga(0,0),wo()})(),zo(),Bo(),Xo(1)},zo=()=>{To(),Io()},To=()=>{Yt.set((()=>{let e;return e=Object.keys(Xt.get()[0]).some(e=>e===Y),e?Y:Z})())},Io=()=>{Zt.set(Uo())},No=e=>{const t=e.currentTarget.value,o=Qt.get().Sheets[t],a=XLSX.utils.sheet_to_row_object_array(o);Xt.set(structuredClone(a))},Ro=e=>Date.parse("1970-01-01T"+e+".000"),jo=e=>e.padStart(8,"0"),Oo=(e,t)=>{const o=Math.max(...t.filter(t=>t<=e),-1);return{i:t.findIndex(e=>e==o)+1,$:e-o}},Po=(e,t)=>{const o=t.split(" "),a=o[1],s=o[3],{h:c,u:l,m:r}=((e,t)=>{try{const o=jo(e),a=jo(t),s=Ro(o),c=Ro(a),l=s/g,r=c/g,n=r-l;return isNaN(n)&&console.error("Error: La duración es NaN"),{h:l,u:r,m:n}}catch(e){}})(a,s);e[se]=c,e[ce]=l,e[le]=a,e[re]=s,e[ne]=r;const n=Zt.get()(r),{i:i,$:d}=Oo(r,n);e[ie]=i,e[de]=d,((e,t)=>{t>0&&(e[U]="R")})(e,d)},Uo=()=>{let e,t=function(o){const a=[[39,79,119,159,199,239,279,319,359,399,439,479,519,559,599],[44,89,134,179,224,269,314,359,404,449,494,539,584,629,674]];for(const t of a)if(t.includes(o)){e=t;break}return t=()=>e,t(o)};return e=>t(e)},Bo=()=>{for(let e=0;e<Xt.get().length;e++){const t=Xt.get()[e];Fo(t);const o=t[ee];Ho(o)?t[U]="Z":Vo(t,o,e)}},Ho=e=>e==be||e.toLowerCase()==L||e.toLowerCase()==z,Vo=(e,t,o)=>{e[U]="A";const a=e[oe],s=e[te],c=e[ae];if(t.includes(_)){Xt.get().splice(o,1);const l=a.split(_),r=s.split(_),n=c.split(_),i=t.split(_);for(let a=0;a<i.length;a++)e[oe]=l[a],e[te]=r[a],e[ae]=n[a],e[ee]=i[a],Po(e,t),Xt.get().splice(o,0,e)}else Po(e,t)},Fo=e=>{e[oe]===v&&(e[oe]=q),e[te]===v&&(e[te]=q),e[W]===v&&(e[W]=e["v"]||q)},Go=t=>{const o=t?`<div class="row">${vo(e[3])}<div class="col-12 col-md-6 col-lg-3"><h6>¿Quiere ver con color las sesiones?</h6><div id="${wt}" class="form-check"></div></div><div class="col-12 col-md-6 col-lg-9"><div id="${xt}" class="form-check"></div></div></div>`:x;ho("6",o);ho("5",t?`<div class="row"><div class="col-12"><p class="d-inline-flex gap-1"><a class="btn btn-outline-info" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">Mostrar o no todas las secciones juntas</a></p><div class="collapse" id="collapseExample"><div id="${lt}" class="form-check"></div></div></div></div>`:x);ho("7",t?`<div class="row"><div class="col-12 col-md-3"><h6>Dibujar:</h6><div id="${rt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Ordenar:</h6><div id="${et}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Qué mostrar?:</h6><div id="${ot}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>¿Ver por lugares o todas las cargas académica?:</h6><div id="${st}" class="form-check"></div></div></div>`:x);ho("8",t?`<div class="row"><svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/></symbol></svg><div class="alert alert-primary d-flex align-items-center" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:"><use xlink:href="#info-fill"/></svg><div>Un <strong>horario</strong> es un bloque con hora de inicio y fin.<br>Una <strong>sección</strong> puede estar en varios días y tener varios horarios.<br>Una <strong>carga académica aprobada</strong> es aquella cuyos horarios no se superponen entre sí.</div></div><div class="col-12 col-md-3"><h6>Buscar las:</h6><div id="${bt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen días libres:</h6><div id="${ft}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen ventana luego de una sección:</h6><div id="${vt}" class="form-check"></div></div><div class="col-12 col-md-3"><h6>Buscar las que tienen máximo de asignaturas por día:</h6><div id="${pt}" class="form-check"></div><div id="${gt}" class="form-check"></div></div></div>`:x),Jo(t)},Jo=e=>{ho("9",e?`<div class="row"><div class="col-12 col-md-2"><h6>Procesado:</h6><div id="${it}" class="form-check"></div></div><div class="col-12 col-md-2"><div id="${At}"></div></div><div class="col-12 col-md-4"><div id="${_t}"></div></div><div class="col-12 col-md-4"><div id="${Dt}"></div></div></div>`:x)},Qo=t=>{const o=t?`<div class="row">${vo(e[2])}<div class="col-12 col-md-8"><h6>Carrera (requerida selección)</h6><div id="${Be}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Jornada (recomendada selección)</h6><div id="${Ve}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-6"><h6>Plan o malla (recomendada selección)</h6><div id="${Ge}" class="form-check"></div></div><div class="col-12 col-md-6"><h6>Semenstres (requerida selección)</h6><div id="${Qe}" class="form-check"></div></div></div><div class="row"><div class="col-12 col-md-8"><h6>Asignaturas (requerida selección)</h6><div id="${We}" class="form-check"></div></div><div class="col-12 col-md-4"><h6>Sección (selección opcional)</h6><div id="${Ze}" class="form-check"></div></div></div>`:x;ho("3",o)},Xo=e=>{if(!e)return Go(0),Qo(0),void Vs(0);Qo(1),Go(1),Zs(),Zo(1),Ko(1),ea(1),ta(1),aa(1),sa(1),Fs(0),Ca(),la(),na(),ra(),ia(),da(),$a(),ha(),ua(),ma(),ba(),va(1),pa(1),Yo(1),Js(2),Vs(0),Qs(),Ba()},Wo=e=>{ho(Ee,e?`<div class="row"><div class="col-12 col-sm-12 col-md-6"><div id="${je}"></div></div><div class="col-12 col-sm-12 col-md-6"><div id="${Mt}"></div></div></div>`:x)},Yo=e=>{ho(je,e?`<div class="d-grid gap-2 col-6 mx-auto"><button type="button" class="btn btn-secondary" id="${Oe}">Mostrar selección</button><button type="button" class="btn btn-secondary" id="${Pe}">Reiniciar filtros</button><button type="button" class="btn btn-secondary" id="${Ue}">Borrar cargas académicas mostradas</button></div>`:x),e&&($o(Oe,A,()=>{Ea()}),$o(Pe,A,()=>{Xo(1)}),$o(Ue,A,()=>{Qs(),Js(1)}))},Zo=e=>{if(1===e){const e=bo(He);ho(Be,e),$o(He,k,()=>{Zo(3),Ao()})}if(2===e||1===e){const t=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),o=lo(t,G),a=fo(o);return void ho(He,a)}3===e&&(ka(1),Ko(2),ea(2),ta(2),aa(2),sa(2),Ca(),Js(2),Vs(0),Qs())},Ko=e=>{if(1===e){const e=bo(Fe);ho(Ve,e),$o(Fe,k,()=>{Ko(3),Ao()})}if(2===e||1===e){const t=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),o=lo(t,X),a=fo(o);return void ho(Fe,a)}3===e&&(ka(2),ea(2),ta(2),aa(2),sa(2),Ca(),Js(2),Vs(0),Qs())},ea=e=>{if(1===e){const e=bo(Je);ho(Ge,e),$o(Je,k,()=>{ea(3),Ao()})}if(2===e||1===e){const t=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),o=lo(t,J),a=fo(o);return void ho(Je,a)}3===e&&(ka(3),ta(2),aa(2),sa(2),Ca(),Js(2),Vs(0),Qs())},ta=e=>{if(1===e){const e=bo(Xe);ho(Qe,e),$o(Xe,k,()=>{ta(3),Ao()})}if(2===e||1===e){const t=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),o=lo(t,W),a=fo(o);return void ho(Xe,a)}3===e&&(ka(4),aa(2),sa(2),Ca(),Js(2),Vs(0),Qs())},oa=()=>Gt[Yt.get()],aa=e=>{if(1===e){const e=bo(Ye);uo(lt),ho(We,e),$o(Ye,k,()=>{ka(5),pa(1),Js(2),Ao(),aa(3),es(1),xs(0),_a(oa()),Ss()})}if(2===e||1===e){const t=Yt.get(),o=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),a=lo(o,t);Kt.set(a);const s=fo(Kt.get());return void ho(Ye,s)}3===e&&(ka(5),sa(2),Ca(),Js(2),Vs(0),Fs(0),Qs(),ca())},sa=e=>{if(1===e){const e=bo(Ke);ho(Ze,e),$o(Ke,k,()=>{ka(6),sa(3),Ao(),ts(1),Ss()})}if(2===e||1===e){const t=1===e?Xt.get():2===e?Wt.get():new Error(`${we} ${e}`),o=lo(t,K),a=fo(o);return void ho(Ke,a)}3===e&&(ka(6),Ca(),Js(2),Vs(0),Qs(),ca())},ca=()=>{Ma(),Va(),Ks()},la=()=>{c.forEach((e,t)=>{const o=yo(M,tt,t,e,t);io(et,o),$o(`${tt}_${t}`,k,()=>{Ya(1)})}),ro(`${tt}_${y}`).checked=1},ra=()=>{l.forEach((e,t)=>{const o=yo(M,at,t,e,t);io(ot,o)}),ro(`${at}_${S}`).checked=1},na=()=>{const e=yo(M,ct,0,o[0],1),t=yo(M,ct,1,o[1],0);io(st,`${e}<div class="form-check"><div class="dropdown"><select class="form-select" aria-label="Default select example" id="${Et}"><option value="5">5</option><option value="10">10</option><option value="25">25</option><option value="50" selected>50</option><option value="75">75</option><option value="100">100</option></select></div></div>${t}`),ro(`${ct}_${y}`).checked=1},ia=()=>{s.forEach((e,t)=>{const o=yo(M,nt,t,e,t);io(rt,o)}),ro(`${nt}_${y}`).checked=1},da=()=>{t.forEach((e,t)=>{const o=t+1,a=yo(M,dt,o,e,o);io(it,a),$o(`${dt}_${o}`,k,()=>{Ka(1)})}),ro(`${dt}_${t.length}`).checked=1},$a=()=>{r.forEach((e,t)=>{const o=yo(E,$t,t,e,t);io(bt,o),$o(`${$t}_${t}`,k,()=>{ga(),ba(),Mo(),Za(1)})}),ro(`${$t}_${S}`).checked=1},ha=()=>{n.forEach((e,t)=>{const o=yo(E,ht,t,e,t);io(ft,o),$o(`${ht}_${t}`,k,()=>{ya(t),ba(),Mo(),Za(1)})}),ro(`${ht}_${y}`).checked=1},ua=()=>{i.forEach((e,t)=>{const o=yo(E,ut,t,e,t);io(vt,o),$o(`${ut}_${t}`,k,()=>{Sa(t),ba(),Mo(),Za(1)})}),ro(`${ut}_${y}`).checked=1},ma=()=>{d.forEach((e,t)=>{const o=yo(E,mt,t,e,t);io(pt,o),$o(`${mt}_${t}`,k,()=>{wa(t),ba(),Mo(),Za(1)})}),ro(`${mt}_${y}`).checked=1},ba=()=>{ws(),fa()},fa=()=>{let e=x;const{p:{values:t}}=Bt;t.forEach((t,o)=>{const a=t.length>2?t.slice(0,t.length).join(", "):2===t.length?` ${t[1]}`:x;let s="";var c;t[0]!=$[2]&&(s=`Cargas académicas ${t[0]}${a}`),t[0]==$[2]&&(s=`${c=t[0],`${c[0].toUpperCase()}${c.substring(1).toLowerCase()}`} las cargas académicas ${a}`),s+=`: <spam id="${St}_${o}"></spam>`;const l=yo(M,yt,o,s,o);e+=l});ho(_t,`<a name="${P}"></a><h6>5 - Selecione una métrica.</h6><p class="form-check-label">Mostrar seleccionado:</p><div class="form-check">${e}</div></div>`),t&&(ro(`${yt}_${y}`).checked=1),t.forEach((e,t)=>{$o(`${yt}_${t}`,k,()=>{os(1)})})},va=e=>{const t=`${yo(M,Ct,0,a[0],0)}${yo(M,Ct,1,a[1],1)}${po(jt)}`;ho(wt,t),$o(`${Ct}_${y}`,k,()=>{pa(0)}),$o(`${Ct}_${S}`,k,()=>{pa(1)}),ro(`${Ct}_${e}`).checked=1},pa=e=>{if(!e)return uo(xt),void va(0);let t=x;Ft.S.forEach(e=>{t+=`<tr><td style="background-color: ${e[0]}">${e[1]}</td></tr>`});ho(xt,`<table class="responsive"><thead><tr><th scope="col">Colores para las sesiones de las asignaturas</th></tr></thead><tbody>${t}</tbody></table>`),va(1);oa().forEach((e,t)=>{let o="";Ft.S.forEach((e,a)=>{o+=`<option style="background-color: ${e[0]}" ${a===t?"selected":x}>${e[1]}</option>`});io(jt,`<label class="form-check-label">Asignatura <br>${e}</label><select class="form-select" id="${It}_${t}">${o}</select>`)})},ga=()=>{ro(`${$t}_${S}`).checked||ro(`${$t}_${w}`).checked||(ro(`${$t}_${S}`).checked=1)},ya=e=>{if(ro(`${ht}_${S}`).checked||ro(`${ht}_${w}`).checked)return 0===e?(ro(`${ht}_${y}`).checked=1,ro(`${ht}_${S}`).checked=0,void(ro(`${ht}_${w}`).checked=0)):void(1!==e&&2!==e||(ro(`${ht}_${y}`).checked=0));ro(`${ht}_${y}`).checked=1},Sa=e=>{if(ro(`${ut}_${S}`).checked||ro(`${ut}_${w}`).checked)return 0===e?(ro(`${ut}_${y}`).checked=1,ro(`${ut}_${S}`).checked=0,void(ro(`${ut}_${w}`).checked=0)):void(1!==e&&2!==e||(ro(`${ut}_${y}`).checked=0));ro(`${ut}_${y}`).checked=1},wa=e=>{if(ro(`${mt}_${S}`).checked||ro(`${mt}_${w}`).checked){if(0===e)return ro(`${mt}_${y}`).checked=1,ro(`${mt}_${S}`).checked=0,ro(`${mt}_${w}`).checked=0,void uo(gt);if(1!==e){if(2===e){let e=[];if(e=oa(),0===e.length)throw alert(ge),ro(`${mt}_${S}`).checked&&(ro(`${mt}_${w}`).checked=0),ro(`${mt}_${S}`).checked||(ro(`${mt}_${y}`).checked=1),new Error(ge);return ro(`${mt}_${y}`).checked=0,void _a(e)}}else ro(`${mt}_${y}`).checked=0}else ro(`${mt}_${y}`).checked=1},_a=e=>{if(ro(`${mt}_${w}`).checked){let t=x;e.forEach((o,a)=>t+=`<option value=${a+1} ${e.length===a?"selected":x}>${a+1}</option >`);ho(gt,`<select class="form-select" id="${Nt}">${t}</select>`),$o(Nt,k,()=>{as(1)})}else uo(gt)},Ca=()=>{let e=[],t=[],o=[];const a=[];Bt._=1,Kt.get().forEach(s=>{e=structuredClone(Gt),e[Yt.get()]=[s],t=Ja(Xt.get(),e),o=lo(t,K),a.push(o.length)}),Bt._=a.reduce((e,t)=>e*t)},xa=e=>Array.from(ro(e).selectedOptions).map(e=>e.textContent),ka=e=>{const t=xa(He),o=xa(Fe),a=xa(Je),s=xa(Xe);Kt.set(xa(Ye));const c=xa(Ke);Gt[G]=t,Gt[X]=e>=2?o:[],Gt[J]=e>=3?a:[],Gt[W]=e>=4?s:[],Gt[Yt.get()]=e>=5?Kt.get():[],Gt[K]=e>=6&&e<=9?c:[],Wt.set(Ja(Xt.get(),Gt))},Aa=e=>{const t=no(e);for(let e=0;e<t.length;e++)if(t[e].checked)return e},Da=e=>{const t=no(e),o=[];for(let e=0;e<t.length;e++)t[e].checked&&o.push(e);return o},Ma=()=>{Ft.selected=[];const e=oa();for(let t=0;t<e.length;t++)Ft.selected.push(ro(`${It}_${t}`).selectedIndex)},Ea=()=>{La({C:1,k:0,A:Aa(at)})},qa=e=>{document.body.style.cursor=e},La=({C:e,k:t,A:o})=>{if(qa(j),!(()=>{if(!Ha())return alert(pe),0;const{_:e}=Bt;return 0===e?(alert(ye),0):e>1881600?(alert(`El buscar ${Gs(e)} cargas académicas, conlleva un tiempo de espera superior a 10 segundos, tenga paciencia y concideración de esta situación`),1):1})())return void 0;ys();const{l:a,D:s}=Bt,c=Wa(),l=c||a!==v&&(Ut.M||Ut[yt]);eo.set(Bt.p.q[Aa(yt)][0][1]),e&&((a===v||Ut.L)&&(Va(),ls()),l&&(_s(),s.length>0&&gs(),xs(1)),c&&vs()),ss(),Cs()&&(e&&!t&&(Ns(0),Rs(0),Aa(ct)?(Ps(),Fs(0)):(Ns(1),Rs(1),Ls(),Hs(),Eo(),Us(),Os(),Fs(1)),Js(3),Vs(1)),!e&&t&&(Fs(0),Hs(),Eo(),Es(),Js(4)),o?(Ys(),Is()):Fs(0),qa(O))},za=e=>e.map(([,e,t])=>[e,t,"","","","","",""]),Ta=()=>[...new Set(Xt.get().filter(e=>"A"===e[U]).map(e=>[e[ne],e[le],e[re],e[se],e[ce],e[ie],e[U]]).filter((e,t,o)=>{const a=e[2]+"|"+e[3];return o.findIndex(e=>e[2]+"|"+e[3]===a)===t}).sort((e,t)=>e[3]-t[3]))],Ia=(e,t,o,a,s)=>{let c=Ro(ja(e));o&&(c+=g);const l=new Date(c),r=`${l.getHours()}:${ja(l.getMinutes())}:${ja(l.getSeconds())}`,n=c/g;c+=g*t;const i=new Date(c),d=`${i.getHours()}:${ja(i.getMinutes())}:${ja(i.getSeconds())}`,$=c/g,h=Zt.get()(t),{i:u}=Oo(t,h),m=[t,r,d,n,$,u,a];return"C"===a&&m.push(s),m},Na=e=>{const t=Zt.get()()[0];for(let o=0;o<e.length;o++){const a=e[o],s=`${a[1]} - ${a[2]}`,c=a[5];if(c>1){let l=a[1];for(let a=0;a<c;a++){const c=Ia(l,t,a>0,"C",s);l=c[2],0==a&&e.splice(o,1);Oa(c,e,3,4)||(e.splice(o,0,c),o++)}o--}}Ra(e)},Ra=e=>{e.sort((e,t)=>e[3]-t[3]||e[4]-t[4])},ja=e=>{const t=e.toString();return 1===t.length||7===t.length?"0"+t:t},Oa=(e,t,o,a)=>t.some(t=>t[o]===e[o]&&t[a]===e[a]),Pa=e=>{for(let t=1;t<e.length;t++){const o=e[t],a=e[t-1],s=o[3]-1-(a[4]+1);if(s>9)throw new Error("Se detecta una ventana mayor a 9 minutos");if(s>-1){const o=a[2],c=Ia(o,s,!0,"CR");e.splice(t,0,c),t++}}},Ua=e=>{e.slice(1).forEach((t,o)=>{const a=e[o];t[3]-1!==a[4]&&console.log(" V:",`El elemento ${o+1} no es consecutivo con el anterior`,t)})},Ba=()=>{oo.set((()=>{const e=Ta();return Na(e),Pa(e),Ua(e),za(e)})())},Ha=()=>Gt[G].length>0&&Gt[W].length>0&&Gt[Yt.get()].length>0,Va=()=>{to.set([]);const e=Yt.get(),t=oo.get(),o=to.get(),a=Gt[e],s=a.length,c=[],l=[];for(let r=0;r<s;r++){const s={"Sección":[],Docente:x,Sala:x};s[e]=[a[r]];const n={T:s[e],L:[]};o.push(n);const i=o.length-1,d=Ja(Wt.get(),s),$=lo(d,K);for(let e=0;e<$.length;e++){const a=$[e];s[K]=[a];const n=Ja(Wt.get(),s),d={I:s[K],N:lo(n,te).join(", "),R:[],j:[],O:[[],[],[],[],[],[]]};o[i].L.push(d);const h=o[i].L,u=h[h.length-1],{j:m,O:v,R:p}=u;let g=[],y=[];if(g=Array.from(new Set(n.map(e=>e[ee]))).map(e=>({Horario:e,"Día":n.find(t=>t[ee]===e).Día})),g.length<=0&&alert(ve),2017!==ao.get()&&(y=g),2017===ao.get()){const t=g[0][ee].split(_),a=g[0].Día.split(_);if(t.length===a.length)for(let e=0;e<t.length;e++)y.push({Horario:t[e],"Día":a[e]});else t.length<a.length?alert(`A la columna Horario de la sección ${o[r].L[e].I} le falta un horario.`):a.length<t.length&&alert(`A la columna Día de la sección ${o[r].L[e].I} le falta un día.`)}for(let a=0;a<y.length;a++){let s=3,l=1;const n=y[a],i=n[ae],d=n[ee];"En linea"!==i&&"Online"!==d||(s-=1,l-=1);const $=so.get()?i:d.split(" ")[0],h=d.split(" "),u={P:$,U:h[s],B:h[l],H:0,V:[]},{B:m,U:v,V:g}=u,S=so.get()?b.indexOf($):f.indexOf($);-1===S&&c.push(o[r].L[e].I),u.H=S;for(let e=0;e<t.length;e++){const o=t[e];if(o[0]===m){if(g.push(e),o[1]===v)break}else{if(o[1]===v){g.push(e);break}g.length>0&&g.push(e)}}p.push(u)}for(let e=0;e<p.length;e++){const{V:o,H:s,B:c,U:r}=p[e],n=o.map(e=>e+t.length*s);if(-1!==s)for(let o=0;o<p.length;o++){const{V:s,H:i,B:d,U:$}=p[o],h=s.map(e=>e+t.length*i);if(-1===i)continue;const u=new Set(n),m=new Set(h),b=u.difference(m).size>0,f=u.isSubsetOf(m),v=m.isSubsetOf(u);b&&f&&(l.push(`${a} ${c} ${r}`),p.splice(e,1)),b&&v&&(l.push(`${a} ${d} ${$}`),p.splice(o,1))}}for(let e=0;e<p.length;e++){const{V:o,H:a}=p[e];for(let e=0;e<o.length;e++){const s=o[e],c=t.length*a+s;m.push(c),v[a].push(s)}}}}c.length>0&&Ga(1,0,c),l.length>0&&Ga(1,1,l)},Fa=e=>`<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" /></symbol></svg><div class="alert alert-warning alert-dismissible fade show" role="alert"><svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Warning:"><use xlink:href="#exclamation-triangle-fill" /></svg>${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`,Ga=(e,t,o=[])=>{const a=[ze,Te];if(!e)return void ho(a[t],x);if(!Array.isArray(o)||0===o.length)return void ho(a[t],Fa("No hay información para mostrar."));const s=[`<strong>Un día no asignado en el excel para ${o.length>1?"las secciones: ":"la sección: "}</strong>${o.join(" - ")}. Revise en la columna "Día" del Excel su correspondiente valor, tiene que ser con nombres de Lunes a Sábado. Al faltarle un día a la sección no se mostrará en la tabla, pero sí se considera en las combinaciones de la lista.`,`<strong>${o.length>1?"Las secciones: ":"La sección: "}</strong>${o.join(" - ")}${o.length>1?" tienen horarios duplicados y por ello se han eliminado.":" tiene un horario duplicado y por ello se ha eliminado."}`];ho(a[t],Fa(s[t]))},Ja=(e,t)=>e.filter(e=>Object.keys(t).every(o=>Array.isArray(t[o])&&t[o].some(t=>"string"==typeof e[o]&&e[o]===t)||0===t[o].length)),Qa=()=>Xa()?6:5,Xa=()=>Gt[X].some(e=>"Vespertino"===e||"Diurno y Vespertino"===e),Wa=()=>Ut.order||Ut.F||Ut.subject||Ut.L||Ut[mt],Ya=e=>{Ut.order=e},Za=e=>{Ut.F=e},Ka=e=>{Ut.M=e},es=e=>{Ut.subject=e},ts=e=>{Ut.L=e},os=e=>{Ut[yt]=e},as=e=>{Ut[mt]=e},ss=()=>{Ya(0),Za(0),os(0),Ka(0),es(0),as(0)},cs=(e,t)=>{const o={},a=((e,t)=>{const o=[];for(let a=t.length-1;a>=0;a--){const s=t[a],c=e%s;o.unshift(c);const l=e/s;e=Math.floor(l)}return o})(e,t);o.G=a;const{J:s,X:c}=(e=>{const t=[],o=[];for(let a=0;a<e.length;a++){const s=e[a],{j:c,O:l}=to.get()[a].L[s];t.push(c),o.push(l)}return{J:t,X:o}})(a);return o.J=s,o.X=c,o},ls=()=>{Bt.o=new Array(Bt._)},rs=()=>to.get().map(e=>e.L.length),ns=e=>{const t=e.J.flat();e[$t]=t.length===[...new Set(t)].length?1:0},is=e=>{const t=[[],[],[],[],[],[]],o=[[],[],[],[],[],[]],a=[0,0,0,0,0,0],{X:s}=e;for(let e=0;e<t.length;e++)for(let c=0;c<s.length;c++)if(s[c][e].length>0){const l=[];for(let t=0;t<s[c][e].length;t++)o[e].includes(s[c][e][t])||l.push(s[c][e][t]),o[e].push(s[c][e][t]);t[e]=t[e].concat([l.sort((e,t)=>e-t)]),a[e]++}for(let e=0;e<t.length;e++){o[e].sort((e,t)=>e-t);for(let o=0;o<t[e].length;o++)t[e]=t[e].sort((e,t)=>e[e.length-1]-t[0])}e.W=t,e.Y=o,e.Z=a},ds=e=>{let t=1;const o=(()=>{if(null===ro(Nt))return Kt.get().length>4?Xa()?Kt.get().length:4:Kt.get().length;return ro(Nt).value})(),{Z:a}=e;for(let e=0;e<a.length;e++)if(a[e]>o){t=0;break}e[mt]=t},$s=(e,t)=>{Bt.o[t]={}},hs=(e,t)=>{Bt.o[t].K=e.X.flat(2).reduce((e,t)=>e+t,0)},us=e=>{const t=[],o=[0,0,0,0,0,0],a=[0,0,0,0,0,0],{W:s,Y:c}=e;for(let e=0;e<s.length;e++)if(0!=s[e].length){t.push(e);const a=s[e];for(let t=1;t<a.length;t++)a[t-1][a[t-1].length-1]!==a[t][0]-1&&o[e]++}for(let e=0;e<c.length;e++){const t=c[e],o=t.length,s=t[0],l=t[o-1]-s+1-o|0;a[e]=l}e.ee=t,e.te=o,e.oe=a},ms=e=>{e[ht]=e.ee.length<Qa()?1:0},bs=(e,t)=>{Bt.o[t].ae=e.oe.reduce((e,t)=>e+t,0)},fs=e=>{const{ee:t,te:o,W:a}=e;let s=0;for(let e=0;e<t.length;e++)o[t[e]]===a[t[e]].length-1&&s++;e[ut]=s===t.length?1:0},vs=()=>{const e=Aa(tt),t=Ds();if(0===e)return void t.sort((e,t)=>e-t);Bt.l!==v&&(e=>{const t=rs(),{o:o}=Bt;Ds().forEach(a=>{o[a]==v&&(o[a]={});const{K:s,ae:c}=Bt.o[a],l=cs(a,t);1!==e&&2!==e||s!=v||hs(l,a),3!==e&&4!==e||c!=v||(is(l),us(l),bs(l,a))})})(e);const{o:o}=Bt;1!==e?2!==e?3!==e?4!==e||t.sort((e,t)=>o[t].ae-o[e].ae):t.sort((e,t)=>o[e].ae-o[t].ae):t.sort((e,t)=>o[t].K-o[e].K):t.sort((e,t)=>o[e].K-o[t].K)},ps=()=>{const e=Aa(tt),{p:{se:t,q:o},D:a}=Bt,s=[];for(let e=0;e<a.length;e++){const t=o[a[e]];for(let e=0;e<t.length;e++){const o=t[e][0];s.includes(o)||s.push(o)}}const c=[];return s.includes($t)&&c.push(ns),c.push(is),s.includes(mt)&&(t[mt].includes(1)||t[mt].includes(2))&&c.push(ds),e>0&&c.push($s),1!==e&&2!==e||c.push(hs),(s.includes(ht)&&(t[ht].includes(1)||t[ht].includes(2))||3===e||4===e||s.includes(ut)&&(t[ut].includes(1)||t[ut].includes(2)))&&c.push(us),s.includes(ht)&&(t[ht].includes(1)||t[ht].includes(2))&&c.push(ms),3!==e&&4!==e||c.push(bs),s.includes(ut)&&(t[ut].includes(1)||t[ut].includes(2))&&c.push(fs),c},gs=()=>{const e=rs(),{D:t,p:{q:o,ce:a},_:s,le:c}=Bt,l=ps();for(let r=0;r<s;r++){const s=cs(r,e);for(let e=0;e<l.length;e++)l[e](s,r);t.forEach(e=>{let t=1;o[e].forEach(e=>{2!==e[1]&&(s[e[0]]===e[1]||(t=0))}),t&&c[a[e]].push(r)})}},ys=()=>{Bt.D=[]},Ss=()=>{Bt.le={}},ws=()=>{Ss(),Bt.p={};const{p:e}=Bt;e.ce=[],e.q=[],e.values=[],e.se={};const{se:t}=e;t[$t]=Da($t),t[ht]=Da(ht),t[ut]=Da(ut),t[mt]=Da(mt);const{le:o}=Bt;t[$t].forEach(a=>{const s=[$t,a],c="S"+ks(a);e.ce.push(c),e.q.push([s]),e.values.push([$[a]]),o[c]=v,t[ht].forEach(t=>{const l=t-1;if(-1!==l){const t="SFD"+ks(l),r=`${c}-${t}`;e.ce.push(r),e.q.push([s,[ht,l]]),e.values.push([$[a],h[l]]),o[r]=v}}),t[ut].forEach(t=>{const l=t-1;if(-1!==l){const t="MOF"+ks(l),r=`${c}-${t}`;e.ce.push(r),e.q.push([s,[ut,l]]),e.values.push([$[a],u[l]]),o[r]=v}}),t[mt].forEach(t=>{const l=t-1;if(-1!==l){const t="SOM"+ks(l),r=`${c}-${t}`;e.ce.push(r),e.q.push([s,[mt,l]]),e.values.push([$[a],m[l]]),o[r]=v}})})},_s=()=>{const e=Aa(yt),t=(o=dt,parseInt(no(o)[Aa(o)].value));var o;const{p:{ce:a},le:s,D:c}=Bt;a.forEach((o,a)=>{3===t&&e!==a&&(s[o]=v),1!==t&&(2!==t&&3!==t||e!==a)||(s[o]===v||Ut[mt]&&(o.includes(mt)||o.includes("SOM")))&&(s[o]=[],c.push(a))})},Cs=()=>Ds()===v?1:0===Ms()?(Qs(),null!==ro(kt)&&uo(kt),0):1,xs=e=>{const{p:{ce:t},le:o}=Bt;t.forEach((a,s)=>{const c=e?o[t[s]]?Gs(o[t[s]].length):"?":x;ho(`${St}_${s}`,c)})},ks=e=>{if(1===e){return"_T"}if(0===e){return"_F"}if(2===e){return"_A"}},As=e=>{{const t={};return t[$t]=eo.get(),{...cs(e,rs()),...t}}},Ds=()=>{const{le:e,p:{ce:t}}=Bt;return e[t[Da(yt)]]},Ms=()=>Ds().length,Es=()=>{const e=ro(kt);if(null==e)return alert(Ce),0;const t=Array.from(e.selectedOptions).map(e=>parseInt(e.value));return 0==t.length?(alert(xe),0):(Bt.l=t,1)},qs=e=>{const t=Math.trunc(Ht.re/e),o=Ht.re%e,a=[];for(let o=0;o<t;o++)a.push([o*e,o*e+e,0]);return o>0&&a.push([t*e,t*e+o,0]),a},Ls=()=>{const e=parseInt(xa(Et));Ht.re=Ms(),Ht.ne=qs(e),Ht.re>p&&(Vt.ne=qs(p))},zs=e=>{0!==Ht.ie||e?Ht.ne.length===Ht.ie+1&&e?alert(So(I,N)):(qa(j),e?Ht.ie++:Ht.ie--,Eo(),Os(),Fs(1),Ht.ne[Ht.ie][2],Ys(),Us(),Is(),qa(O)):alert(So(T,N))},Ts=e=>{0!==Vt.ie||e?Vt.ne.length===Vt.ie+1&&e?alert(So(I,R)):(qa(j),e?Vt.ie++:Vt.ie--,Bs(),Js(3)):alert(So(T,R))},Is=()=>{const e=Ht.ie!=v?`_${Ht.ie}`:x;location.hash="#"+(0===Ht.ie?`${P}`:`${Ie}${e}`)},Ns=e=>{Ht.ie=e?0:v},Rs=e=>{Vt.ie=e?0:v},js=()=>{Ht.ie=ro(qt).selectedIndex},Os=()=>{const e=Ht.ne[Ht.ie][0],t=Ht.ne[Ht.ie][1];Ht.de=e,Ht.$e=t,Bt.l=Ds().slice(e,t)},Ps=()=>{Bt.l=Bt.o.map((e,t)=>t)},Us=()=>{Ht.ne[Ht.ie][2]=1},Bs=()=>{Vt.ne[Vt.ie][2]=1},Hs=()=>{let e=x;for(let t=0;t<Ht.ne.length;t++)e+=`<div id="${Ie}_${t}"></div>`;ho(`${Ie}`,e)},Vs=e=>{ho(Mt,e?'<iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfaidqhUi9_qqaiSjIAhwFQrCHji_-459KmzP3uibq1d1Z1Ow/viewform?embedded=true" width="500" height="443" frameborder="0" marginheight="0" marginwidth="0">Cargando…</iframe>':x)},Fs=e=>{if(e){let e=x;for(let t=0;t<Ht.ne.length;t++)e+=`<option ${Ht.ie===t?"selected":x}>${Gs(t+1)}: ${Gs(Ht.ne[t][0]+1)} al lugar ${Gs(Ht.ne[t][1])}</option>`;const t=`<div><h6>Rangos de cargas académicas</h6><div class="d-grid mx-auto"><spam> Total de rangos: ${Gs(Ht.ne.length)}</spam><spam> Total de cargas académicas: ${Gs(Ht.re)}</spam><spam> Rango actual: </spam><select class="form-select" aria-label="Default select example" id="${qt}">${e}</select><div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${Lt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${Lt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div></div>`;ho(Le,t),ro(Le).classList.add("shadow-lg","mb-5",Co()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2"),$o(qt,k,()=>{js(),Os(),Fs(1),Ht.ne[Ht.ie][2]?alert(`Ya se ha desplegado el rango ${Ht.ie+1}.`):Ys(),Is(),Us(),qa(O)}),$o(`${Lt}_${y}`,A,()=>{zs(0)}),$o(`${Lt}_${S}`,A,()=>{zs(1)})}else uo(Le),ro(Le).classList.remove("shadow-lg","mb-5",Co()?"bg-dark":"bg-white","rounded","flotante","col-4","col-md-2")},Gs=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".").toString(),Js=e=>{if(1==e)return uo(qe),uo(Me),uo(ze),uo(Te),void Jo(0);if(2==e){const e=`<h6>Métricas:</h6><div class="form-check"><p class="form-check-label">Cargas académicas a buscar: ${Gs(Bt._)}</p></div>`;return ho(Me,e),ho(At,e),uo(ze),uo(Te),uo(Dt),void uo(qe)}if(3==e){let e=x;Vt.ne&&(e=`<div class="btn-group"><button type="button" class="btn btn-outline-primary" id="${zt}_0"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"></path></svg></button><button type="button" class="btn btn-outline-primary" id="${zt}_1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg></button></div>`);let t=x;Vt.ne&&(t=`Rango: <text class="form-check-label">${Vt.ie+1} de ${Vt.ne.length}</text>`);const o=`<a href="#${P}" class="btn btn-outline-primary flotante ${Co()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;ho(qe,o);const a=bo(kt);ho(Dt,`<h6>Número/s de carga/s académica/s (Selección opcional)</h6><text class="form-check-label">Color azul: Cargas académicas aprobadas</text><br><text class="form-check-label">Color rojo: Cargas académicas rechazadas</text><br>${t}<div>${a}</select><div class="margen d-grid">${e}<button type="button" class="btn btn-secondary" id="${Tt}">${_e}</button></div></div></div>`),Vt.ne&&($o(`${zt}_${y}`,A,()=>{Ts(0)}),$o(`${zt}_${S}`,A,()=>{Ts(1)})),$o(`${Tt}`,A,()=>{La({C:0,k:1,A:1})}),uo(kt);let s=[];if(Vt.ne){if(0===Vt.ne.length)return console.alert(Se);s=(()=>{const e=Vt.ne[Vt.ie][0],t=Vt.ne[Vt.ie][1];return Vt.de=e,Vt.$e=t,Ds().slice(e,t)})()}else s=Ds();0;{const e=eo.get()?$e:ue;s.forEach(t=>{const o=`<option style="color:${e}" value=${t}>${Gs(t+1)}</option>`;io(kt,o)})}return}if(4==e){const e=`<a href="#${P}" class="btn btn-outline-primary flotante ${Co()?"bg-dark":"bg-white"}">Ir a las métricas</a>`;return void ho(qe,e)}},Qs=()=>{Fs(0),Xs()},Xs=()=>{uo(Ie)},Ws=e=>{const t=Ht.ie!=v?`_${Ht.ie}`:x;io(`${Ie}${t}`,e)},Ys=()=>{const e=Aa(nt),t=Aa(Ct);0!==e?1!==e?2!==e?3!==e?4!==e||(t?(Ma(),$c()):dc()):t?lc():rc():t?sc():cc():t?(Ma(),ac()):oc():t?(Ma(),tc()):ec()},Zs=()=>{Ft.S=[["#ffdf89","Anaranjado"],["#fffdbf","Amarillo"],["#e9ffba","Verde limón"],["#defefe","Turquesa"],["#cff4fc","Celeste"],["#cfe2ff","Azúl"],["#e2d9f3","Purpura"],["#e0cffc","Indigo"],["#f7d6e6","Rosado"],["#e8ba86","Marrón"],["#d3bead","Café"],["#f8f9fa","Plomo"]]},Ks=()=>{let e=x;const t=structuredClone(oo.get());for(let o=0;o<t.length;o++){const a=t[o];e+=`<tr><th scope="row">${a[0]} - ${a[1]}</td><td>${a[2]}</td><td>${a[3]}</td><td>${a[4]}</td><td>${a[5]}</td><td>${a[6]}</td><td>${a[7]}</td></tr>`}ho(lt,`<div class=""><table class="table table-bordered"><caption><h5></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${e}</tbody></table><a class="btn btn-outline-info" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">Mostrar o no todas las secciones juntas</a></div>`);const o=ro(lt).firstElementChild.getElementsByTagName("table")[0],a=Co();for(let e=0;e<to.get().length;e++){const t=to.get()[e],s=t.T,c=Ft.S[Ft.selected[e]][0];for(let e=0;e<t.L.length;e++){const l=t.L[e],r=l.I;for(let e=0;e<l.R.length;e++){const t=l.R[e],n=t.H;for(let e=0;e<t.V.length;e++){const l=t.V[e];o.rows[l+1].cells[n+1].insertAdjacentHTML(D,`<span class="badge rounded-pill bs-body-color" style="background-color:${c}; color:${a?"#adb5bd":"#ffffff"}">${s.toString().replace(" ","<br>")} <br> ${r}</span>`)}}}}},ec=()=>{let e=x;const{l:t}=Bt;for(let o=0;o<t.length;o++){const a=As(t[o]);let s=structuredClone(oo.get());for(let e=0;e<a.G.length;e++){const t=to.get()[e].L[a.G[e]];let o=t.I[0];for(let e=0;e<t.R.length;e++){const a=t.R[e];let c=a.H;for(let e=0;e<a.V.length;e++)s[a.V[e]][c+2]+=` ${o}`}}let c=x;for(let e=0;e<s.length;e++)c+=`<tr><th scope="row">${s[e][0]} - ${s[e][1]}</th><td>${s[e][2]}</td><td>${s[e][3]}</td><td>${s[e][4]}</td><td>${s[e][5]}</td><td>${s[e][6]}</td><td>${s[e][7]}</td></tr>`;const l=a[$t]?`<p style="color:${$e}">Carga académica ${Gs(t[o]+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(t[o]+1)} rechazada</p>`;e+=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${l}<div class="margen"><button type="button" class="btn btn-${a[$t]?"primary":"danger"}" id="${Rt}${t[o]}" data-bs-toggle="modal" data-bs-target="#exampleModal${t[o]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${c}</tbody></table></div><div class="modal fade" id="exampleModal${t[o]}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel${t[o]}">${l}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${t[o]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div>`}Ws(e);for(let e=0;e<t.length;e++)$o(`${Rt}${t[e]}`,A,()=>{nc(t[e])})},tc=()=>{let e=x;const t=to.get(),{l:o}=Bt;for(let a=0;a<o.length;a++){const s=As(o[a]);let c=structuredClone(oo.get()),l=structuredClone(oo.get());for(let e=0;e<s.G.length;e++){const o=t[e].T,a=t[e].L[s.G[e]],r=a.I[0];for(let t=0;t<a.R.length;t++){const s=a.R[t],n=s.H;for(let t=0;t<s.V.length;t++){const a=s.V[t];l[a][n+2]=l[a][n+2].length>0?he:Ft.S[Ft.selected[e]][0],c[a][n+2]+=` ${o} <b>${r}</b>`}}}let r=x;for(let e=0;e<c.length;e++)r+=`<tr><th scope="row">${c[e][0]} - ${c[e][1]}</th><td style="background-color: ${l[e][2]}">${c[e][2]}</td><td style="background-color: ${l[e][3]}">${c[e][3]}</td><td style="background-color: ${l[e][4]}">${c[e][4]}</td><td style="background-color: ${l[e][5]}">${c[e][5]}</td><td style="background-color: ${l[e][6]}">${c[e][6]}</td><td style="background-color: ${l[e][7]}">${c[e][7]}</td></tr>`;const n=s[$t]?`<p style="color:${$e}">Carga académica ${Gs(o[a]+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(o[a]+1)} rechazada</p>`;e=`<div class="table-responsive"><table class="table table-bordered"><caption><h5>${n}<div class="margen"><button type="button" class="btn btn-${s[$t]?"primary":"danger"}" id="drawResumeColor${o[a]}" data-bs-toggle="modal" data-bs-target="#exampleModal${o[a]}">Mostrar resumen</button></div></h5></caption><thead><tr><th scope="col">Horarios</th><th scope="col">Lunes</th><th scope="col">Martes</th><th scope="col">Miércoles</th><th scope="col">Jueves</th><th scope="col">Viernes</th><th scope="col">Sábado</th></tr></thead><tbody>${r}</tbody></table></div><div class="modal fade" id="exampleModal${o[a]}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="1"><div class="modal-dialog modal-xl"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="exampleModalLabel${o[a]}">${n}</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body" id="modal${o[a]}"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button></div></div></div></div>`,Ws(e),$o(`drawResumeColor${o[a]}`,A,()=>{ic(o[a])})}},oc=()=>{let e=x;const{l:t}=Bt;for(let o=0;o<t.length;o++){const a=As(t[o]);let s=x;for(let e=0;e<a.G.length;e++){let t=x;const o=a.G[e],c=to.get()[e],l=c.T,r=c.L[o],n=r.I[0],i=r.N;for(let e=0;e<r.R.length;e++){const{P:o,B:a,U:s}=r.R[e];t+=`${o} ${a} - ${s} `}s+=`<tr><th scope="row">${l}</th><td>${n}</td><td>${i}</td><td>${t}</td></tr>`}e+=`<div class="table-responsive"><table class="table"><caption><h5>${a[$t]?`<p style="color:${$e}">Carga académica ${Gs(t[o]+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(t[o]+1)} rechazada</p>`}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${s}</tbody></table></div`}Ws(e)},ac=()=>{const{l:e}=Bt;for(let t=0;t<e.length;t++){const o=As(e[t]),a=structuredClone(oo.get());let s=x;const c=[];for(let l=0;l<o.G.length;l++){let r=x;const n=to.get()[l],{T:i,L:d}=n,$=d[o.G[l]],h=$.I[0],u=$.N;c.push(Ft.S[Ft.selected[l]][0]);for(let e=0;e<$.R.length;e++){const t=$.R[e],o=t.H;for(let e=0;e<t.V.length;e++){const s=t.V[e];a[s][o+2]!=x&&(c[a[s][o+2]]=he,c[l]=he),a[s][o+2]=`${l}`}r+=`${t.P} ${t.B} - ${t.U} `}s+=`<tr><th scope="row">${i}</th><td id="${e[t]}-${l}">${h}</td><td>${u}</td><td>${r}</td></tr>`}const l=o[$t]?`<p style="color:${$e}">Carga académica ${Gs(e[t]+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(e[t]+1)} rechazada</p>`;Ws(`<div class="table-responsive"><table class="table"><caption><h5>${l}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${s}</tbody></table></div`);for(let o=0;o<c.length;o++)ro(`${e[t]}-${o}`).style.background=c[o]}},sc=()=>{alert("No se ha implementado la lista en tabla en color.")},cc=()=>{let e=x;const{l:t}=Bt;for(let o=0;o<t.length;o++){const a=As(t[o]);let s=" Asignatura - Sección - Días y horas<br>";for(let e=0;e<a.G.length;e++){let t=x;const o=to.get()[e],c=o.T,l=o.L[a.G[e]],r=l.I[0];for(let e=0;e<l.R.length;e++){const{P:o,B:a,U:s}=l.R[e];t+=`${o}-${a} - ${s} `}s+=`${c} - ${r} - ${t}<br>`}e+=`${a[$t]?`<p style="color:${$e}">Horario ${Gs(t[o]+1)} aprobada</p>`:`<p style="color:${ue}">Horario ${Gs(t[o]+1)} rechazada</p>`}${s}<br>`}Ws(e)},lc=()=>{let e=x;const{l:t}=Bt;for(let o=0;o<t.length;o++){const a=As(t[o]);let s=x;for(let e=0;e<Kt.get().length;e++){s+=`${to.get()[e].L[a.G[e]].I[0]} `}e+=`${a[$t]?`<p style="color:${$e}">Carga académica ${Gs(t[o]+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(t[o]+1)} rechazada</p>`}: ${s}<br>`}Ws(e)},rc=()=>{let e=x;const{l:t}=Bt;for(let o=0;o<t.length;o++){const a=As(t[o]);let s=x;for(let e=0;e<Kt.get().length;e++){s+=`${to.get()[e].L[a.G[e]].I[0]} `}e+=`Carga académica ${Gs(t[o]+1)}: ${s}<br>`}Ws(e)},nc=e=>{const t=As(e);let o=x;for(let e=0;e<t.G.length;e++){const a=to.get()[e],s=a.T,c=a.L[t.G[e]],l=c.I[0],r=c.N;let n=x;for(let e=0;e<c.R.length;e++){const{P:t,B:o,U:a}=c.R[e];n+=`${t} ${o} - ${a} `}o+=`<tr><th scope="row">${s}</th><td>${l}</td><td>${r}</td><td>${n}</td></tr>`}const a=t[$t]?`<p style="color:${$e}">Carga académica ${Gs(e+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(e+1)} rechazada</p>`;ho(`modal${e}`,`<div class="table-responsive"><table class="table"><caption><h5>${a}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${o}</tbody></table></div`)},ic=e=>{const t=As(e),o=structuredClone(oo.get());let a=x;const s=[];for(let c=0;c<t.G.length;c++){let l=x;const{T:r,L:n}=to.get()[c],{I:i,N:d,R:$}=n[t.G[c]],h=i[0];s.push(Ft.S[Ft.selected[c]][0]);for(let e=0;e<$.length;e++){const{H:t,V:a,P:r,B:n,U:i}=$[e],d=t;for(let e=0;e<a.length;e++){const t=a[e];o[t][d+2]!=x&&(s[o[t][d+2]]=he,s[c]=he),o[t][d+2]=`${c}`}l+=`${r} ${n||"?"} - ${i||"?"} `}a+=`<tr><th scope="row">${r}</th><td id="${e+1}-${c}">${h}</td><td>${d}</td><td>${l}</td></tr>`}const c=t[$t]?`<p style="color:${$e}">Carga académica ${Gs(e+1)} aprobada</p>`:`<p style="color:${ue}">Carga académica ${Gs(e+1)} rechazada</p>`;ho(`modal${e}`,`<div class="table-responsive"><table class="table"><caption><h5>${c}</h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Horario</th></tr></thead><tbody>${a}</tbody></table></div`);for(let t=0;t<s.length;t++)ro(`${e+1}-${t}`).style.background=s[t]},dc=()=>{let e=x;const t=to.get();for(let o=0;o<t.length;o++){const{T:a,L:s}=t[o];for(let t=0;t<s.length;t++){const{I:o,N:c,R:l}=s[t];let r=x;const n=o[0];for(let e=0;e<l.length;e++){const{P:t,B:o,U:a}=l[e];r+=`${t} ${o} - ${a} `}e+=`<tr><th scope="row">${a}</th><td>${n}</td><td>${c}</td><td>${r}</td></tr>`}}Ws(`<div class="table-responsive"><table class="table"><caption><h5><p style="color:${$e}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`)},$c=()=>{let e=x;const t=[],o=to.get();for(let a=0;a<o.length;a++){const{T:s,L:c}=o[a];t.push(Ft.S[Ft.selected[a]][0]);for(let t=0;t<c.length;t++){const{I:o,N:l,R:r}=c[t];let n=x;const i=o[0];for(let e=0;e<r.length;e++){const{P:t,B:o,U:a}=r[e];n+=`${t} ${o||"?"} - ${a||"?"} `}e+=`<tr><th scope="row">${s}</th><td name="_${a}">${i}</td><td>${l}</td><td>${n}</td></tr>`}}Ws(`<div class="table-responsive"><table class="table"><caption><h5><p style="color:${$e}">Todas las secciones en una carga académica</p></h5></caption><thead><tr><th scope="col">Asignatura</th><th scope="col">Sección</th><th scope="col">Profesor</th><th scope="col">Carga académica</th></tr></thead><tbody>${e}</tbody></table></div`);for(let e=0;e<t.length;e++)no(`_${e}`).forEach(o=>o.style.background=t[e])};